{# 
  Generated by JinjaGenerator for template 'updfam'
    at 2025-10-29T22:35:10.218329

  Used macros:
  - nav()
  - date(xlab, xvar, xdt)
  - source(xvar, xx)
  - note(xvar, xx)
  - small_date(kind, xvar, xx, verbose)
  - birth(xvar, xx, verbose)
  - death(xvar, xx, verbose)
  - w_birth(xcnt, wcnt, xx, verbose)
  - w_death(xcnt, wcnt, xx, verbose)
  - parent(xcnt, xx, psex)
  - insert_parent(xcnt)
  - selector_fevent(xcnt)
  - insert_fevent(xcnt)
  - insert_witness(xcnt, wcnt)
  - one_witness(xcnt, wcnt)
  - one_fevent(xcnt, has_fevents)
  - card_header(xx, yy)
  - ev(vv, xx)
  - insert_child(xcnt)
  - invert_children(xcnt)
  - child(xcnt)

  Used includes:
  - css
  - hed
  - raw include
  - toolbar
  - characters
  - trl
  - copyr
  - js
  - upd_js

  Used variables:
  - lang (x1)
  - evar_m (x30)
  - evar_i (x6)
  - body_prop (x1)
  - message_to_wizard (x1)
  - include_menubar (x1)
  - xdt.day (x3)
  - xdt.month (x4)
  - xdt.year (x3)
  - xdt.prec (x7)
  - xdt.ormonth (x4)
  - xdt.calendar (x5)
  - xdt.orday (x3)
  - xdt.oryear (x3)
  - xdt.text (x1)
  - day_input (x9)
  - month_input (x9)
  - year_input (x9)
  - xx_src (x1)
  - xx_note (x1)
  - verbose (x10)
  - true (x10)
  - xx.create.kind_day (x3)
  - xx.create.kind_month (x3)
  - xx.create.kind_year (x3)
  - xx.create.kind_place (x1)
  - xx.first_name (x3)
  - xx.surname (x2)
  - xx.occ (x2)
  - xx.create (x2)
  - xx.create.occupation (x1)
  - datalist_places (x2)
  - xcnt (x6)
  - datalist_fnames (x3)
  - evar.m (x3)
  - evar.ip (x1)
  - evar.iexcl (x2)
  - evar.fexcl (x2)
  - datalist_snames (x3)
  - datalist_occupations (x3)
  - i (x4)
  - event.e_name (x19)
  - event.e_place (x1)
  - event.e_note (x2)
  - event.e_src (x3)
  - fwitness.surname (x3)
  - fwitness.first_name (x3)
  - fwitness.create (x2)
  - fwitness.occ (x3)
  - fwitness.index (x2)
  - fwitness.sex (x2)
  - fwitness.create.sex (x3)
  - fwitness.create.occupation (x1)
  - fwitness_kind (x7)
  - prefix_base_password (x2)
  - wcnt (x1)
  - comment (x2)
  - e.m (x1)
  - e.ins_vvxx (x1)
  - l_on1s (x2)
  - datalist_sources (x1)
  - has_fevents (x3)
  - has_fwitness (x1)
  - action (x1)
  - j (x4)
  - test_ev (x1)
  - test_ch (x1)
  - hidden (x1)
  - digest (x1)
  - evar_ip (x2)
  - nl (x6)
  - evar_i2 (x1)
  - evar_ini1 (x2)
  - evar_ini2 (x2)
  - cnt (x2)
  - child.create (x2)
  - child.first_name (x2)
  - child.occ (x4)
  - child.surname (x2)
  - child.index (x2)
  - child.sex (x2)
  - child.create.sex (x3)
  - child.create.occupation (x1)
  - father.surname (x1)
  - evar_psrc (x2)
  - evar_dsrc (x1)
  - fsources (x3)
  - evar_rdsrc (x1)
  - bvar.origin_file (x1)
  - origin_file (x1)
  - query_time (x1)
#}

<!DOCTYPE html>
<html lang="{{ lang }}" id="updform">
    <head>
        <!-- $Id: updfam.txt v7.1 12/12/2024 05:28:35 $ -->
        <!-- Copyright (c) 1998-2007 INRIA -->
        <meta name="robots" content="none">
        <meta charset="UTF-8">
        <meta name="viewport"
              content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="shortcut icon"
              href="{{ url_for("static", path="images/favicon_gwd.png") }}">
        <title>
            {% if evar_m == "ADD_FAM" or evar_m == "ADD_FAM_OK" %}
                {{ _('add::family/families', variant='0') |capitalize }}
            {% else %}
                {% if evar_m == "ADD_PAR" or evar_m == "ADD_PAR_OK" %}
                    {{ _('add::parents', variant='0') |capitalize }}
                {% else %}
                    {% if evar_m == "MOD_FAM" or evar_m == "MOD_FAM_OK" %}
                        {{ _('modify::family/families', variant='0') |capitalize }} # {{ evar_i }}
                    {% else %}
                        {% if evar_m == "MRG_DUP_FAM_Y_N" or evar_m == "MRG_FAM" or evar_m == "MRG_FAM_OK" or evar_m == "MRG_MOD_FAM_OK" %}
                            {{ _('merge::family/families', variant='1') |capitalize }} # {{ evar_i }}
                        {% endif %}
                    {% endif %}
                {% endif %}
            {% endif %}
        </title>
        {% include 'css.html.j2' %}
    </head>
    <body {{ body_prop }} id="family">
        {% include 'hed.html.j2' %}
        {{ message_to_wizard }}
        <div class="container">
            {{ include_menubar }}
            {% with %}
                {% set datalist_fnames = "list=\"datalist_fnames\" data-book=\"fn\"" %}
                {% with %}
                    {% set datalist_snames = "list=\"datalist_snames\" data-book=\"sn\"" %}
                    {% with %}
                        {% set datalist_places = "list=\"datalist_places\" data-book=\"place\"" %}
                        {% with %}
                            {% set datalist_occupations = "list=\"datalist_occupations\" data-book=\"occu\"" %}
                            {% with %}
                                {% set datalist_sources = "list=\"datalist_sources\" data-book=\"src\"" %}
                                {% macro nav() %}
                                    <div class="container fixed-top" role="navigation">
                                        <nav class="navbar navbar-light justify-content-center mx-2" id="banner">
                                            <nav class="nav nav-pills nav-fill">
                                                <a class="nav-item nav-link px-2 py-1"
                                                   href="#family"
                                                   title="{{ _("parents") |capitalize }}"><i class="fa fa-person fa-fw" aria-hidden="true"></i><i class="fa fa-person-dress" aria-hidden="true"></i><span class="d-none d-md-inline-flex ml-1">{{ _("parents") |capitalize }}</span></a>
                                                <a class="nav-item nav-link px-2 py-1"
                                                   href="#events"
                                                   title="{{ _('event/events', variant='1') |capitalize }}"><i class="fa fa-graduation-cap fa-fw" aria-hidden="true"></i><span class="d-none d-md-inline-flex ml-1">{{ _('event/events', variant='1') |capitalize }}</span></a>
                                                <a class="nav-item nav-link px-2 py-1"
                                                   href="#children"
                                                   title="{{ _('child/children', variant='1') |capitalize }}"><i class="fa fa-child fa-fw" aria-hidden="true"></i><span class="d-none d-md-inline-flex ml-1">{{ _('child/children', variant='1') |capitalize }}</span></a>
                                                <a class="nav-item nav-link px-2 py-1"
                                                   href="#sources"
                                                   title="{{ _('source/sources', variant='1') |capitalize }}"><i class="fa fa-star fa-fw" aria-hidden="true"></i><span class="d-none d-lg-inline-flex ml-1">{{ _('source/sources', variant='1') |capitalize }}</span></a>
                                                <a class="nav-item nav-link px-2 py-1"
                                                   href="#comments"
                                                   title="{{ _('comment', variant='1') |capitalize }}"><i class="fa fa-file-lines fa-fw" aria-hidden="true"></i><span class="d-none d-lg-inline-flex ml-1">{{ _("comment") |capitalize }}</span></a>
                                            </nav>
                                        </nav>
                                    </div>
                                {% endmacro %}
                                {% macro date(xlab, xvar, xdt) %}
                                    {% with %}
                                        {% set day_input = "pattern=\"(?:0?"+_('1-9')+"|1"+_('0-9')+"|2"+_('0-9')+"|3"+_('0-1')+")\" size=\"2\" maxlength=\"2\" placeholder=\" \"" %}
                                        {% with %}
                                            {% set month_input = "pattern=\"(?:0?"+_('1-9')+"|1"+_('0-2')+"|VD|BR|FM|NI|PL|VT|GE|FL|PR|ME|TH|FT|JC|vd|br|fm|ni|pl|vt|ge|fl|pr|me|th|ft|jc)\" size=\"1\" maxlength=\"2\" placeholder=\" \"" %}
                                            {% with %}
                                                {% set year_input = "pattern=\""+_('?><~/+\-')+"?\d*/?\" size=\"4\" maxlength=\"8\" placeholder=\" \"" %}
                                                <div class="row mt-1">
                                                    <div class="col-sm-1 col-md-2 col-form-label">xlab</div>
                                                    <div class="col col-sm-auto form-inline">
                                                        {% if _('!dates order', variant='0') == "ddmmyy" or _('!dates order', variant='0') == "ddmmyyyy" or _('!dates order', variant='0') == "dmyyyy" %}
                                                            <label>
                                                                <input type="text"
                                                                       class="form-control"
                                                                       name="xvar_dd"
                                                                       value="{{ xdt.day }}"
                                                                       {{ day_input }}
                                                                       placeholder="{{ _('year/month/day', variant='2') }}">
                                                                <span class="ml-sm-1 ml-md-2">{{ _('year/month/day', variant='2') }}</span>
                                                            </label>
                                                            <label>
                                                                <span id="xvar_mm_sel">
                                                                    <input type="text"
                                                                           class="form-control ml-sm-2 ml-md-3"
                                                                           name="xvar_mm"
                                                                           value="{{ xdt.month }}"
                                                                           {{ month_input }}>
                                                                </span>
                                                                <span class="ml-sm-1 ml-md-2">{{ _('year/month/day', variant='1') }}</span>
                                                            </label>
                                                            <label>
                                                                <input type="text"
                                                                       class="form-control ml-sm-2 ml-md-3"
                                                                       name="xvar_yyyy"
                                                                       value="{{ xdt.year }}"
                                                                       {{ year_input }}>
                                                                <span class="ml-sm-1 ml-md-2">{{ _('year/month/day', variant='0') }}</span>
                                                            </label>
                                                        {% else %}
                                                            {% if _('!dates order', variant='0') == "mmddyyyy" %}
                                                                <label>
                                                                    <span id="xvar_mm_sel">
                                                                        <input type="text"
                                                                               class="form-control"
                                                                               name="xvar_mm"
                                                                               value="{{ xdt.month }}"
                                                                               {{ month_input }}>
                                                                    </span>
                                                                    <span class="ml-sm-1 ml-md-2">{{ _('year/month/day', variant='1') }}</span>
                                                                </label>
                                                                <label>
                                                                    <input type="text"
                                                                           class="form-control ml-sm-2 ml-md-3"
                                                                           name="xvar_dd"
                                                                           value="{{ xdt.day }}"
                                                                           {{ day_input }}>
                                                                    <span class="ml-sm-1 ml-md-2">{{ _('year/month/day', variant='2') }}</span>
                                                                </label>
                                                                <label>
                                                                    <input type="text"
                                                                           class="form-control ml-sm-2 ml-md-3"
                                                                           name="xvar_yyyy"
                                                                           value="{{ xdt.year }}"
                                                                           {{ year_input }}>
                                                                    <span class="ml-sm-1 ml-md-2">{{ _('year/month/day', variant='0') }}</span>
                                                                </label>
                                                            {% else %}
                                                                <label>
                                                                    <input type="text"
                                                                           class="form-control"
                                                                           name="xvar_yyyy"
                                                                           value="{{ xdt.year }}"
                                                                           {{ year_input }}>
                                                                    <span class="ml-sm-1 ml-md-2">{{ _('year/month/day', variant='0') }}</span>
                                                                </label>
                                                                <label>
                                                                    <span id="xvar_mm_sel">
                                                                        <input type="text"
                                                                               class="form-control ml-sm-2 ml-md-3"
                                                                               name="xvar_mm"
                                                                               value="{{ xdt.month }}"
                                                                               {{ month_input }}>
                                                                    </span>
                                                                    <span class="ml-sm-1 ml-md-2">{{ _('year/month/day', variant='1') }}</span>
                                                                </label>
                                                                <label>
                                                                    <input type="text"
                                                                           class="form-control ml-sm-2 ml-md-3"
                                                                           name="xvar_dd"
                                                                           value="{{ xdt.day }}"
                                                                           {{ day_input }}>
                                                                    <span class="ml-sm-1 ml-md-2">{{ _('year/month/day', variant='2') }}</span>
                                                                </label>
                                                            {% endif %}
                                                        {% endif %}
                                                    </div>
                                                    <div class="col-10 col-lg ml-auto form-inline">
                                                        <label for="xvar_prec" class="sr-only col-form-label">{{ _('precision', variant='0') }}</label>
                                                        <select class="form-control pl-lg-1 pr-lg-0 px-xl-2"
                                                                name="xvar_prec"
                                                                id="xvar_prec">
                                                            <option value="sure"{% if xdt.prec == "sure" %} selected{% endif %}>{{ _('exact', variant='0') }}</option>
                                                            <option value="about"{% if xdt.prec == "about" %} selected{% endif %}>{{ _('about (date)', variant='0') }}</option>
                                                            <option value="maybe"{% if xdt.prec == "maybe" %} selected{% endif %}>{{ _('possibly (date)', variant='0') }}</option>
                                                            <option value="before"{% if xdt.prec == "before" %} selected{% endif %}>{{ _('before (date)', variant='0') }}</option>
                                                            <option value="after"{% if xdt.prec == "after" %} selected{% endif %}>{{ _('after (date)', variant='0') }}</option>
                                                            <option value="oryear"{% if xdt.prec == "oryear" %} selected{% endif %}>…{{ _("or") }}…</option>
                                                            <option value="yearint"{% if xdt.prec == "yearint" %} selected{% endif %}>…{{ _("between (date)") }}…</option>
                                                        </select>
                                                        <label for="xvar_cal" class="sr-only col-form-label">{{ _('calendar/calendars', variant='0') }}</label>
                                                        <select class="form-control pl-lg-1 pr-lg-0 px-xl-2 ml-sm-1 ml-md-3"
                                                                name="xvar_cal"
                                                                id="xvar_cal"
                                                                onchange="changeCalendar('xvar_mm_sel','xvar_mm','{{ xdt.month }}',this),changeCalendar('xvar_ormonth_sel','xvar_ormonth','{{ xdt.ormonth }}',this)">
                                                            <option value=""{% if xdt.calendar == "" %} selected{% endif %}>-</option>
                                                            <option value="G"{% if xdt.calendar == "gregorian" %} selected{% endif %}>
                                                                {{ _('gregorian/julian/french/hebrew', variant='0') |capitalize }}
                                                            </option>
                                                            <option value="J"{% if xdt.calendar == "julian" %} selected{% endif %}>
                                                                {{ _('gregorian/julian/french/hebrew', variant='1') |capitalize }}
                                                            </option>
                                                            <option value="F"{% if xdt.calendar == "french" %} selected{% endif %}>
                                                                {{ _('gregorian/julian/french/hebrew', variant='2') |capitalize }}
                                                            </option>
                                                            <option value="H"{% if xdt.calendar == "hebrew" %} selected{% endif %}>
                                                                {{ _('gregorian/julian/french/hebrew', variant='3') |capitalize }}
                                                            </option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-sm-1 col-md-2"></div>
                                                    <div class="col col-sm-auto form-inline">
                                                        {% if _('!dates order', variant='0') == "ddmmyy" or _('!dates order', variant='0') == "ddmmyyyy" or _('!dates order', variant='0') == "dmyyyy" %}
                                                            <label>
                                                                <input type="text"
                                                                       class="form-control"
                                                                       name="xvar_orday"
                                                                       value="{{ xdt.orday }}"
                                                                       {{ day_input }}>
                                                                <span class="ml-sm-1 ml-md-2">{{ _('year/month/day', variant='2') }}</span>
                                                            </label>
                                                            <label>
                                                                <span id="xvar_ormonth_sel">
                                                                    <input type="text"
                                                                           class="form-control ml-sm-1 ml-md-3"
                                                                           name="xvar_ormonth"
                                                                           value="{{ xdt.ormonth }}"
                                                                           {{ month_input }}>
                                                                </span>
                                                                <span class="ml-sm-1 ml-md-2">{{ _('year/month/day', variant='1') }}</span>
                                                            </label>
                                                            <label>
                                                                <input type="text"
                                                                       class="form-control ml-sm-1 ml-md-3"
                                                                       name="xvar_oryear"
                                                                       value="{{ xdt.oryear }}"
                                                                       {{ year_input }}>
                                                                <span class="ml-sm-1 ml-md-2">{{ _('year/month/day', variant='0') }}</span>
                                                            </label>
                                                        {% else %}
                                                            {% if _('!dates order', variant='0') == "mmddyyyy" %}
                                                                <label>
                                                                    <span id="xvar_ormonth_sel">
                                                                        <input type="text"
                                                                               class="form-control"
                                                                               name="xvar_ormonth"
                                                                               value="{{ xdt.ormonth }}"
                                                                               {{ month_input }}>
                                                                    </span>
                                                                    <span class="ml-sm-1 ml-md-2">{{ _('year/month/day', variant='1') }}</span>
                                                                </label>
                                                                <label>
                                                                    <input type="text"
                                                                           class="form-control ml-sm-1 ml-md-3"
                                                                           name="xvar_orday"
                                                                           value="{{ xdt.orday }}"
                                                                           {{ day_input }}>
                                                                    <span class="ml-sm-1 ml-md-2">{{ _('year/month/day', variant='2') }}</span>
                                                                </label>
                                                                <label>
                                                                    <input type="text"
                                                                           class="form-control ml-sm-1 ml-md-3"
                                                                           name="xvar_oryear"
                                                                           value="{{ xdt.oryear }}"
                                                                           {{ year_input }}>
                                                                    <span class="ml-sm-1 ml-md-2">{{ _('year/month/day', variant='0') }}</span>
                                                                </label>
                                                            {% else %}
                                                                <label>
                                                                    <input type="text"
                                                                           class="form-control"
                                                                           name="xvar_oryear"
                                                                           value="{{ xdt.oryear }}"
                                                                           {{ year_input }}>
                                                                    <span class="ml-sm-1 ml-md-2">{{ _('year/month/day', variant='0') }}</span>
                                                                </label>
                                                                <label>
                                                                    <span id="xvar_ormonth_sel">
                                                                        <input type="text"
                                                                               class="form-control ml-sm-1 ml-md-3"
                                                                               name="xvar_ormonth"
                                                                               value="{{ xdt.ormonth }}"
                                                                               {{ month_input }}>
                                                                    </span>
                                                                    <span class="ml-sm-1 ml-md-2">{{ _('year/month/day', variant='1') }}</span>
                                                                </label>
                                                                <label>
                                                                    <input type="text"
                                                                           class="form-control ml-sm-1 ml-md-3"
                                                                           name="xvar_orday"
                                                                           value="{{ xdt.orday }}"
                                                                           {{ day_input }}>
                                                                    <span class="ml-sm-1 ml-md-2">{{ _('year/month/day', variant='2') }}</span>
                                                                </label>
                                                            {% endif %}
                                                        {% endif %}
                                                    </div>
                                                    <div class="col-10 col-lg">
                                                        <label for="xvar_text" class="col-form-label sr-only"></label>
                                                        <input type="text"
                                                               class="form-control"
                                                               name="xvar_text"
                                                               maxlength="100"
                                                               value="{{ xdt.text }}"
                                                               id="xvar_text"
                                                               placeholder="…{{ _("or") }} {{ _('text', variant='0') }}">
                                                    </div>
                                                </div>
                                            {% endwith %}
                                        {% endwith %}
                                    {% endwith %}
                                {% endmacro %}
                                {% macro source(xvar, xx) %}
                                    <div class="row">
                                        <label for="xvar_src" class="col-sm-1 col-form-label">{{ _('source/sources', variant='0') |capitalize }}</label>
                                        <div class="col-sm-11">
                                            <textarea class="form-control" name="xvar_src" id="xvar_src" rows="1">{{ xx_src }}</textarea>
                                        </div>
                                    </div>
                                {% endmacro %}
                                {% macro note(xvar, xx) %}
                                    <div class="row">
                                        <label for="xvar_note" class="col-sm-1 col-form-label">{{ _('note/notes', variant='0') |capitalize }}</label>
                                        <div class="col-sm-11">
                                            <textarea class="form-control" name="xvar_note" id="xvar_note" rows="1">{{ xx_note }}</textarea>
                                        </div>
                                    </div>
                                {% endmacro %}
                                {% macro small_date(kind, xvar, xx, verbose) %}
                                    {% with %}
                                        {% set day_input = "pattern=\"(?:0?"+_('1-9')+"|1"+_('0-9')+"|2"+_('0-9')+"|3"+_('0-1')+")\" size=\"2\" maxlength=\"2\"" %}
                                        {% with %}
                                            {% set month_input = "pattern=\"(?:0?"+_('1-9')+"|1"+_('0-2')+"|VD|BR|FM|NI|PL|VT|GE|FL|PR|ME|TH|FT|JC|vd|br|fm|ni|pl|vt|ge|fl|pr|me|th|ft|jc)\" size=\"1\" maxlength=\"2\"" %}
                                            {% with %}
                                                {% set year_input = "pattern=\""+_('?><~/+\-')+"?\d*/?\" size=\"4\" maxlength=\"8\"" %}
                                                <div class="row align-items-center">
                                                    <span class="col-sm-2 col-form-label">{{ _("kind") |capitalize }}</span>
                                                    <div class="col-sm-auto d-inline-flex">
                                                        {% if _('!dates order', variant='0') == "ddmmyy" or _('!dates order', variant='0') == "ddmmyyyy" or _('!dates order', variant='0') == "dmyyyy" %}
                                                            <label for="xvar_dd"
                                                                   class="col-form-label{% if verbose == true %} sr-only{% endif %}">
                                                                {{ _('year/month/day', variant='2') }}
                                                            </label>
                                                            <input type="text"
                                                                   class="form-control mr-2"
                                                                   name="xvar_dd"
                                                                   id="xvar_dd"
                                                                   value="{{ xx.create.kind_day }}"
                                                                   placeholder="{{ _('dd/mm/yyyy', variant='0') }}"
                                                                   {{ day_input }}>
                                                            <label for="xvar_mm"
                                                                   class="col-form-label{% if verbose == true %} sr-only{% endif %}">
                                                                {{ _('year/month/day', variant='1') }}
                                                            </label>
                                                            <input type="text"
                                                                   class="form-control mr-2"
                                                                   name="xvar_mm"
                                                                   id="xvar_mm"
                                                                   value="{{ xx.create.kind_month }}"
                                                                   placeholder="{{ _('dd/mm/yyyy', variant='1') }}"
                                                                   {{ month_input }}>
                                                            <label for="xvar_yyyy"
                                                                   class="col-form-label{% if verbose == true %} sr-only{% endif %}">
                                                                {{ _('year/month/day', variant='0') }}
                                                            </label>
                                                            <input type="text"
                                                                   class="form-control mr-2"
                                                                   name="xvar_yyyy"
                                                                   id="xvar_yyyy"
                                                                   value="{{ xx.create.kind_year }}"
                                                                   placeholder="{{ _('dd/mm/yyyy', variant='2') }}"
                                                                   {{ year_input }}>
                                                        {% else %}
                                                            {% if _('!dates order', variant='0') == "mmddyyyy" %}
                                                                <label for="xvar_mm"
                                                                       class="col-form-label{% if verbose == true %} sr-only{% endif %}">
                                                                    {{ _('year/month/day', variant='1') }}
                                                                </label>
                                                                <input type="text"
                                                                       class="form-control mr-2"
                                                                       name="xvar_mm"
                                                                       id="xvar_mm"
                                                                       value="{{ xx.create.kind_month }}"
                                                                       placeholder="{{ _('dd/mm/yyyy', variant='1') }}"
                                                                       {{ month_input }}>
                                                                <label for="xvar_dd"
                                                                       class="col-form-label{% if verbose == true %} sr-only{% endif %}">
                                                                    {{ _('year/month/day', variant='2') }}
                                                                </label>
                                                                <input type="text"
                                                                       class="form-control mr-2"
                                                                       name="xvar_dd"
                                                                       id="xvar_dd"
                                                                       value="{{ xx.create.kind_day }}"
                                                                       placeholder="{{ _('dd/mm/yyyy', variant='0') }}"
                                                                       {{ day_input }}>
                                                                <label for="xvar_yyyy"
                                                                       class="col-form-label{% if verbose == true %} sr-only{% endif %}">
                                                                    {{ _('year/month/day', variant='0') }}
                                                                </label>
                                                                <input type="text"
                                                                       class="form-control mr-2"
                                                                       name="xvar_yyyy"
                                                                       id="xvar_yyyy"
                                                                       value="{{ xx.create.kind_year }}"
                                                                       placeholder="{{ _('dd/mm/yyyy', variant='2') }}"
                                                                       {{ year_input }}>
                                                            {% else %}
                                                                <label for="xvar_yyyy"
                                                                       class="col-form-label{% if verbose == true %} sr-only{% endif %}">
                                                                    {{ _('year/month/day', variant='0') }}
                                                                </label>
                                                                <input type="text"
                                                                       class="form-control mr-2"
                                                                       name="xvar_yyyy"
                                                                       id="xvar_yyyy"
                                                                       value="{{ xx.create.kind_year }}"
                                                                       placeholder="{{ _('dd/mm/yyyy', variant='2') }}"
                                                                       {{ year_input }}>
                                                                <label for="xvar_mm"
                                                                       class="col-form-label{% if verbose == true %} sr-only{% endif %}">
                                                                    {{ _('year/month/day', variant='1') }}
                                                                </label>
                                                                <input type="text"
                                                                       class="form-control mr-2"
                                                                       name="xvar_mm"
                                                                       id="xvar_mm"
                                                                       value="{{ xx.create.kind_month }}"
                                                                       placeholder="{{ _('dd/mm/yyyy', variant='1') }}"
                                                                       {{ month_input }}>
                                                                <label for="xvar_dd"
                                                                       class="col-form-label{% if verbose == true %} sr-only{% endif %}">
                                                                    {{ _('year/month/day', variant='2') }}
                                                                </label>
                                                                <input type="text"
                                                                       class="form-control mr-2"
                                                                       name="xvar_dd"
                                                                       id="xvar_dd"
                                                                       value="{{ xx.create.kind_day }}"
                                                                       placeholder="{{ _('dd/mm/yyyy', variant='0') }}"
                                                                       {{ day_input }}>
                                                            {% endif %}
                                                        {% endif %}
                                                    </div>
                                                    <label for="xvar_pl"
                                                           class="{% if verbose == true %}sr-only{% endif %} col-sm-1 col-form-label">
                                                        {{ _('place/places', variant='0') }}
                                                    </label>
                                                    <div class="col">
                                                        <input type="text"
                                                               class="form-control"
                                                               name="xvar_pl"
                                                               value="{{ xx.create.kind_place }}"
                                                               id="xvar_pl"
                                                               placeholder="{{ _('place/places', variant='0') |capitalize }}"
                                                               {{ datalist_places }}>
                                                    </div>
                                                </div>
                                            {% endwith %}
                                        {% endwith %}
                                    {% endwith %}
                                {% endmacro %}
                                {% macro birth(xvar, xx, verbose) %}
                                    {{ small_date('birth', 'xvarb', 'xx', 'verbose') }}
                                {% endmacro %}
                                {% macro death(xvar, xx, verbose) %}
                                    {{ small_date('death', 'xvard', 'xx', 'verbose') }}
                                {% endmacro %}
                                {% macro w_birth(xcnt, wcnt, xx, verbose) %}
                                    {{ small_date('birth', 'excnt_witnwcnt_b', 'fwitness', 'verbose') }}
                                {% endmacro %}
                                {% macro w_death(xcnt, wcnt, xx, verbose) %}
                                    {{ small_date('death', 'excnt_witnwcnt_d', 'fwitness', 'verbose') }}
                                {% endmacro %}
                                {% macro parent(xcnt, xx, psex) %}
                                    <div class="row{% if xcnt > 1 %} mt-3{% endif %}">
                                        <label for="paxcnt_fn" class="col-sm-2 col-form-label">
                                            {{ _('first name/first names', variant='0') |capitalize }} <span class="font-weight-bold text-uppercase">
                                            (
                                            {% if xx.first_name != "" or xx.surname != "" %}
                                                {{ nth_c(_('M/F', variant='0') +_('M/F', variant='1')+"N", "psex") }}
                                            {% else %}
                                                {% if xcnt == 1 %}
                                                    {{ _('M/F', variant='0') }}
                                                {% else %}
                                                    {{ _('M/F', variant='1') }}
                                                {% endif %}
                                            {% endif %}
                                        )</span>
                                    </label>
                                    <div class="col-sm-8">
                                        <input class="form-control"
                                               type="text"
                                               name="paxcnt_fn"
                                               value="{{ xx.first_name }}"
                                               id="paxcnt_fn"
                                               placeholder="{{ _('first name/first names', variant='0') |capitalize }}"
                                               {{ datalist_fnames }}
                                               {% if evar.m == "ADD_FAM" and xx.first_name == "" %}autofocus{% endif %}>
                                    </div>
                                    <label for="paxcnt_occ" class="col-auto col-form-label sr-only">{{ _("number") |capitalize }}</label>
                                    <div class="col-sm-2">
                                        <input class="form-control"
                                               type="number"
                                               name="paxcnt_occ"
                                               min="0"
                                               value="{% if xx.occ == "" %}0{% else %}{{ xx.occ }}{% endif %}"
                                               id="paxcnt_occ"
                                               title="{{ _("number") |capitalize }} (occurence)">
                                    </div>
                                </div>
                                <div class="row mt-2">
                                    <label for="paxcnt_sn" class="col-sm-2 col-form-label">{{ _('surname/surnames', variant='0') |capitalize }}</label>
                                    <div class="col-sm-8">
                                        <input class="form-control"
                                               type="text"
                                               name="paxcnt_sn"
                                               value="{{ xx.surname }}"
                                               id="paxcnt_sn"
                                               placeholder="{{ _('surname/surnames', variant='0') |capitalize }}"
                                               {{ datalist_snames }}>
                                    </div>
                                    <div class="col-sm-2">
                                        <select class="form-control" id="paxcnt_p_selct" name="paxcnt_p">
                                            <option value="create"{% if xx.create == "create" %} selected{% endif %}>
                                                {{ _('create', variant='0') |capitalize }}
                                            </option>
                                            <option value="link"{% if xx.create == "link" %} selected{% endif %}>{{ _('link', variant='0') |capitalize }}</option>
                                        </select>
                                    </div>
                                </div>
                                <div id="paxcnt_p_selct_data">
                                    {{ birth('paxcnt', 'xx', 'true') }}{{ death('paxcnt', 'xx', 'true') }}
                                    <div class="row">
                                        <label for="paxcnt_occu" class="col-sm-2 col-form-label">
                                            {{ _('occupation/occupations', variant='0') |capitalize }}
                                        </label>
                                        <div class="col-sm">
                                            <input class="form-control"
                                                   name="paxcnt_occu"
                                                   id="paxcnt_occu"
                                                   placeholder="{{ _('occupation/occupations', variant='0') |capitalize }}"
                                                   value="{{ xx.create.occupation }}"
                                                   {{ datalist_occupations }}>
                                        </div>
                                    </div>
                                </div>
                            {% endmacro %}
                            {% macro insert_parent(xcnt) %}
                                <div class="row my-2">
                                    <label for="ins_paxcnt_n" class="col-form-label col-2">{{ _("insert") |capitalize }}</label>
                                    <div class="form-inline col-10 ml-auto">
                                        <div class="input-group">
                                            <select class="custom-select form-control bg-light"
                                                    id="ins_paxcnt_n"
                                                    name="ins_paxcnt_n">
                                                {% for i in range(1, 6) %}<option>{{ i }}</option>{% endfor %}
                                            </select>
                                            <div class="input-group-append">
                                                <label class="btn btn-outline-primary">
                                                    {{ _('parents', variant='0') }}
                                                    <input class="ml-1" type="checkbox" name="ins_paxcnt" value="on">
                                                </label>
                                                <button type="submit"
                                                        class="btn btn-outline-primary"
                                                        title="{{ _('insert::event/events', variant='0') |capitalize }}/{{ _('event/events', variant='1') }}">
                                                    OK
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            {% endmacro %}
                            {% macro selector_fevent(xcnt) %}
                                <select class="form-control custom-select font-weight-bold"
                                        id="fevent_selectxcnt"
                                        onchange="show_fevent_label($('#e_namexcnt').prop('defaultValue'), 'xcnt')">
                                    <option value=""{% if event.e_name == "" %} selected{% endif %} disabled>
                                        {{ _('select/delete an event', variant='0') |capitalize }}
                                    </option>
                                    <option disabled>───────────────</option>
                                    <option value="#marr"{% if event.e_name == "#marr" %} selected{% endif %}>
                                        {{ _("marriage event") |capitalize }}
                                    </option>
                                    <option value="#nmar"{% if event.e_name == "#nmar" %} selected{% endif %}>
                                        {{ _("no marriage event") |capitalize }}
                                    </option>
                                    <option value="#enga"{% if event.e_name == "#enga" %} selected{% endif %}>{{ _("engage event") |capitalize }}</option>
                                    <option value="#nmen"{% if event.e_name == "#nmen" %} selected{% endif %}>{{ _("no mention") |capitalize }}</option>
                                    <option value="#marb"{% if event.e_name == "#marb" %} selected{% endif %}>{{ _("marriage bann") |capitalize }}</option>
                                    <option value="#marc"{% if event.e_name == "#marc" %} selected{% endif %}>
                                        {{ _("marriage contract") |capitalize }}
                                    </option>
                                    <option value="#marl"{% if event.e_name == "#marl" %} selected{% endif %}>
                                        {{ _("marriage licence") |capitalize }}
                                    </option>
                                    <option value="#pacs"{% if event.e_name == "#pacs" %} selected{% endif %}>{{ _("PACS") |capitalize }}</option>
                                    <option value="#div"{% if event.e_name == "#div" %} selected{% endif %}>{{ _("divorce event") |capitalize }}</option>
                                    <option value="#sep"{% if event.e_name == "#sep" %} selected{% endif %}>{{ _("separate event") |capitalize }}</option>
                                    <option value="#anul"{% if event.e_name == "#anul" %} selected{% endif %}>{{ _("annulation") |capitalize }}</option>
                                    <option value="#resi"{% if event.e_name == "#resi" %} selected{% endif %}>{{ _("residence") |capitalize }}</option>
                                    <option disabled>───────────────</option>
                                    <option value=""
                                            {% if not "#" in event.e_name and event.e_name != "" %}selected{% endif %}
                                            id="customxcnt">{{ _("custom event") |capitalize }}</option>
                                    <option disabled>───────────────</option>
                                    <option value="" id="deletexcnt">{{ _('select/delete an event', variant='1') |capitalize }}</option>
                                </select>
                            {% endmacro %}
                            {% macro insert_fevent(xcnt) %}
                                <div class="row mt-2">
                                    <label for="ins_eventxcnt_n" class="col-form-label col-2">{{ _("insert") |capitalize }}</label>
                                    <div class="form-inline col-10 ml-auto">
                                        <div class="input-group">
                                            <select class="form-control bg-light border-primary border-right-0"
                                                    id="ins_eventxcnt_n"
                                                    name="ins_eventxcnt_n">
                                                {% for i in range(1, 11) %}<option>{{ i }}</option>{% endfor %}
                                            </select>
                                            <div class="input-group-append">
                                                <label class="btn btn-outline-primary border-left-0">
                                                    {{ _('event/events', variant='2') }}
                                                    <input class="ml-1" type="checkbox" name="ins_eventxcnt" value="on">
                                                </label>
                                                <button type="submit"
                                                        class="btn btn-outline-primary"
                                                        title="{{ _('insert::event/events', variant='0') |capitalize }}/{{ _('event/events', variant='1') }}">
                                                    OK
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            {% endmacro %}
                            {% macro insert_witness(xcnt, wcnt) %}
                                <div class="row mt-3 mb-1">
                                    <label for="excnt_ins_witnwcnt_n" class="col-form-label col-2">{{ _("insert") |capitalize }}</label>
                                    <div class="form-inline col-10 ml-auto">
                                        <div class="input-group">
                                            <select class="form-control bg-light border-primary border-right-0"
                                                    id="excnt_ins_witnwcnt_n"
                                                    name="excnt_ins_witnwcnt_n">
                                                {% for i in range(1, 11) %}<option>{{ i }}</option>{% endfor %}
                                            </select>
                                            <div class="input-group-append">
                                                <label class="btn btn-outline-primary border-left-0">
                                                    {{ _('witness/witness/witnesses', variant='3') }}
                                                    <input class="ml-1" type="checkbox" name="excnt_ins_witnwcnt" value="on">
                                                </label>
                                                <button type="submit"
                                                        class="btn btn-outline-primary"
                                                        title="{{ _('insert::witness/witness/witnesses', variant='0') |capitalize }}/{{ _('witness/witness/witnesses', variant='2') }}">
                                                    OK
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            {% endmacro %}
                            {% macro one_witness(xcnt, wcnt) %}
                                <hr>
                                <div class="form-group mt-1">
                                    <div class="row">
                                        <h5 class="col-form-label col-2">{{ _('witness/witness/witnesses', variant='0') |capitalize }} wcnt</h5>
                                        <div class="col-2">
                                            <select class="form-control"
                                                    name="excnt_witnwcnt_p"
                                                    id="excnt_witnwcnt_p_selct">
                                                <option value="create"
                                                        {% if fwitness.surname == "" and fwitness.first_name == "" or fwitness.create == "create" %}selected{% endif %}>
                                                    {{ _('create', variant='0') |capitalize }}
                                                </option>
                                                <option value="link"{% if fwitness.create == "link" %} selected{% endif %}>
                                                    {{ _('link', variant='0') |capitalize }}
                                                </option>
                                            </select>
                                        </div>
                                        <div class="col-4">
                                            <select class="form-control" name="excnt_witnwcnt_kind">
                                                <option value=""{% if fwitness_kind == "" %} selected{% endif %}>
                                                    {{ _('witness/witnesses', variant='0') |capitalize }}
                                                </option>
                                                <option value="info"{% if fwitness_kind == "info" %} selected{% endif %}>
                                                    {{ _('informant/informant/informant', variant='2') |capitalize }}
                                                </option>
                                                <option value="atte"{% if fwitness_kind == "atte" %} selected{% endif %}>
                                                    {{ _('present/present/present', variant='2') |capitalize }}
                                                </option>
                                                <option value="ment"{% if fwitness_kind == "ment" %} selected{% endif %}>
                                                    {{ _('mentioned/mentioned/mentioned', variant='2') |capitalize }}
                                                </option>
                                                <option value="offi"{% if fwitness_kind == "offi" %} selected{% endif %}>
                                                    {{ _('civil registrar/civil registrar/civil registrar', variant='2') |capitalize }}
                                                </option>
                                                <option value="reli"{% if fwitness_kind == "reli" %} selected{% endif %}>
                                                    {{ _('parrish registrar/parrish registrar/parrish registrar', variant='2') |capitalize }}
                                                </option>
                                                <option value="othe"{% if fwitness_kind == "othe" %} selected{% endif %}>
                                                    {{ _('other/other/other', variant='2') |capitalize }}
                                                </option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <label for="excnt_witnwcnt_fn" class="col-sm-2 col-form-label">
                                            {{ _('first name/first names', variant='0') |capitalize }}
                                        </label>
                                        <div class="col-sm-6">
                                            <input type="text"
                                                   class="form-control"
                                                   name="excnt_witnwcnt_fn"
                                                   id="excnt_witnwcnt_fn"
                                                   value="{{ fwitness.first_name }}"
                                                   placeholder="{{ _('first name/first names', variant='0') |capitalize }}"
                                                   {{ datalist_fnames }}>
                                        </div>
                                        <label for="excnt_witnwcnt_occ" class="col-sm-auto col-form-label">{{ _('number', variant='0') |capitalize }}</label>
                                        <div class="col-sm-2">
                                            <input type="number"
                                                   class="form-control"
                                                   name="excnt_witnwcnt_occ"
                                                   id="excnt_witnwcnt_occ"
                                                   min="0"
                                                   value="{{ fwitness.occ }}"
                                                   placeholder="#">
                                        </div>
                                    </div>
                                    <div class="row">
                                        <label for="excnt_witnwcnt_sn" class="col-sm-2 col-form-label">
                                            {{ _('surname/surnames', variant='0') |capitalize }}
                                        </label>
                                        <div class="col-sm-6">
                                            <input type="text"
                                                   class="form-control"
                                                   name="excnt_witnwcnt_sn"
                                                   id="excnt_witnwcnt_sn"
                                                   value="{{ fwitness.surname }}"
                                                   placeholder="{{ _('surname/surnames', variant='0') |capitalize }}"
                                                   {{ datalist_snames }}>
                                        </div>
                                        <div id="excnt_witnwcnt_p_selct_mod" class="col-form-label ml-2">
                                            {% if fwitness.index != "-1" %}
                                                <a href="{{ prefix_base_password }}m=MOD_IND&i={{ fwitness.index }}"
                                                   title="{{ _('modify::person/persons', variant='0') |capitalize }} {{ fwitness.first_name }}{% if fwitness.occ != "" %}.{{ fwitness.occ }}{% endif %} {{ fwitness.surname }}"
                                                   aria-label="{{ nth_c(_('M/F', variant='0') +_('M/F', variant='1')+"N", fwitness.sex) }}">
                                                    <i class="fa fa-user-pen fa-fw {% if fwitness.sex == 1 %}fe{% endif %}male ml-2 mr-1"
                                                       aria-hidden="true"></i>
                                                {{ _("modify") |capitalize }} {{ nth(_('nth') , wcnt) }} {{ _('witness/witness/witnesses', variant='0') }}</a>
                                            </a>
                                        {% endif %}
                                    </div>
                                    <div id="excnt_witnwcnt_p_selct_sex" class="col-form-label">
                                        <div class="form-inline">
                                            <div class="col-sm-auto">{{ _("sex") |capitalize }}</div>
                                            <div class="form-check form-check-inline ml-5">
                                                <label class="form-check-label">
                                                    <input class="form-check-input"
                                                           type="radio"
                                                           name="excnt_witnwcnt_sex"
                                                           value="M"
                                                           {% if fwitness.create.sex == "male" %}checked{% endif %}>
                                                    {{ _('M/F', variant='0') }}
                                                </label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <label class="form-check-label">
                                                    <input class="form-check-input"
                                                           type="radio"
                                                           name="excnt_witnwcnt_sex"
                                                           value="N"
                                                           {% if fwitness.create.sex == "neuter" %}checked{% endif %}>
                                                    ?
                                                </label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <label class="form-check-label">
                                                    <input class="form-check-input"
                                                           type="radio"
                                                           name="excnt_witnwcnt_sex"
                                                           value="F"
                                                           {% if fwitness.create.sex == "female" %}checked{% endif %}>
                                                    {{ _('M/F', variant='1') }}
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row" id="excnt_witnwcnt_p_selct_data">
                                    <label for="excnt_witnwcnt_occu" class="col-sm-2 col-form-label">
                                        {{ _('occupation/occupations', variant='0') |capitalize }}
                                    </label>
                                    <div class="col-sm-6">
                                        <input class="form-control"
                                               type="text"
                                               name="excnt_witnwcnt_occu"
                                               id="excnt_witnwcnt_occu"
                                               value="{{ fwitness.create.occupation }}"
                                               placeholder="{{ _('occupation/occupations', variant='0') |capitalize }}"
                                               {{ datalist_occupations }}>
                                    </div>
                                    <div class="form-inline col-sm-auto">
                                        <div class="custom-control custom-checkbox mr-3">
                                            <input class="custom-control-input"
                                                   type="checkbox"
                                                   name="excnt_witnwcnt_od"
                                                   id="excnt_witnwcnt_od">
                                            <label for="excnt_witnwcnt_od" class="custom-control-label">{{ _("of course dead") |capitalize }}</label>
                                        </div>
                                        <div class="custom-control custom-checkbox">
                                            <input class="custom-control-input"
                                                   type="checkbox"
                                                   name="excnt_witnwcnt_pub"
                                                   id="excnt_witnwcnt_pub">
                                            <label for="excnt_witnwcnt_pub" class="custom-control-label">{{ _("public") |capitalize }}</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        {% endmacro %}
                        {% macro one_fevent(xcnt, has_fevents) %}
                            <div class="row">
                                <h5 class="col-form-label col-sm-2 mb-1 text-uppercase">
                                    <label for="e_namexcnt" class="mb-0">{{ _('event/events', variant='0') |capitalize }} xcnt</label>
                                </h5>
                                <div class="col-sm-3">{{ selector_fevent(xcnt) }}</div>
                                <div class="col-sm-7">
                                    <label id="fevent_label_selectorxcnt"
                                           style="display:none"
                                           class="other_evts w-100">
                                        <input type="text"
                                               class="form-control font-weight-bold"
                                               name="e_namexcnt"
                                               value="{% if event.e_name == "" %}#marr{% else %}{{ event.e_name }}{% endif %}"
                                               id="e_namexcnt"
                                               placeholder="{{ _('event/events', variant='0') |capitalize }}">
                                    </label>
                                </div>
                            </div>
                            <div class="row mb-2">
                                <label for="e_placexcnt" class="col-sm-2 col-form-label">{{ _('place/places', variant='0') |capitalize }}</label>
                                <div class="col-sm-10">
                                    <input class="form-control"
                                           type="text"
                                           name="e_placexcnt"
                                           value="{{ event.e_place }}"
                                           id="e_placexcnt"
                                           placeholder="{{ _('place/places', variant='0') |capitalize }}"
                                           {{ datalist_places }}>
                                </div>
                            </div>
                            {{ date(_('date/dates', variant='0') |capitalize, "e_datexcnt", "event_date") }}
                            <div class="row mt-2">
                                <label for="e_notexcnt" class="col-sm-2 col-form-label">{{ _('note/notes', variant='1') |capitalize }}</label>
                                <div class="col-sm-10 d-inline-flex align-items-start">
                                    {% if event.e_name == "#marr" and event.e_note == "" and comment != "" and not "ADD" in e.m %}
                                        <a type="button"
                                           class="btn btn-warning transfer-btn col-form-label font-weight-bold text-monospace mr-1"
                                           title="{{ _("move union comments to notes") |capitalize }}">┎></a>
                                    {% endif %}
                                    <textarea class="form-control"
                                              name="e_notexcnt"
                                              rows="1"
                                              id="e_notexcnt"
                                              {% if event.e_name == "#marr" %}data-marr{% endif %}
                                              placeholder="{{ _('note/notes', variant='1')|capitalize }}">{{ event.e_note }}</textarea>
                                </div>
                            </div>
                            <div class="row mt-0">
                                <label for="e_srcxcnt" class="col-sm-2 col-form-label">{{ _('source/sources', variant='0') |capitalize }}</label>
                                <div class="col-sm-10">
                                    {% if event.e_src != "" %}
                                        <textarea class="form-control"
                                                  name="e_srcxcnt"
                                                  rows="1"
                                                  id="e_srcxcnt"
                                                  placeholder="{{ _('source/sources', variant='0')|capitalize }}"
                                                  {{ l_on1s }}>{{ event.e_src }}</textarea>
                                    {% else %}
                                        <input type="text"
                                               class="form-control"
                                               name="e_srcxcnt"
                                               maxlength="1000"
                                               id="e_srcxcnt"
                                               placeholder="{{ _('source/sources', variant='0') |capitalize }}"
                                               value="{{ event.e_src }}"
                                               {{ datalist_sources }}>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="row">
                                {% if has_fevents and has_fwitness %}
                                    {# foreach not implemented yet #}
                                {% else %}
                                    <div class="col-12">{{ insert_witness(xcnt, "0") }}</div>
                                {% endif %}
                            </div>
                            <hr class="w-100">
                        {% endmacro %}
                        {% macro card_header(xx, yy) %}
                            <h3 class="card-header py-1 text-center"
                                id="xx"
                                aria-label="§ {{ _('yy', variant='1') |capitalize }}">
                                {{ _('yy', variant='1') |capitalize }}
                            </h3>
                        {% endmacro %}
                        <h1 {% if evar.m == "ADD_FAM" or evar.m == "ADD_FAM_OK" and evar.ip == "" %}class="mt-5"{% endif %}>
                            {% if evar_m == "ADD_FAM" or evar_m == "ADD_FAM_OK" %}
                                {{ _('add::family/families', variant='0') |capitalize }}
                            {% else %}
                                {% if evar_m == "ADD_PAR" or evar_m == "ADD_PAR_OK" %}
                                    {{ _("add::parents") |capitalize }} {# foreach not implemented yet #}
                                {% else %}
                                    {% if evar_m == "MOD_FAM" or evar_m == "MOD_FAM_OK" %}
                                        {{ _('modify::family/families', variant='0') |capitalize }} # {{ evar_i }}
                                    {% else %}
                                        {% if evar_m == "MRG_DUP_FAM_Y_N" or evar_m == "MRG_FAM" or evar_m == "MRG_FAM_OK" or evar_m == "MRG_MOD_FAM_OK" %}
                                            {{ _('merge::family/families', variant='1') |capitalize }} # {{ evar_i }}
                                        {% endif %}
                                    {% endif %}
                                {% endif %}
                            {% endif %}
                        </h1>
                        {% with %}
                            {% set l_on1s = "onkeydown=\"if (event.keyCode == 13) if (!event.shiftKey) javascript:document.upd.submit()\"" %}
                            {% macro ev(vv, xx) %}
                                {{ e.ins_vvxx }}
                            {% endmacro %}
                            <form method="post"
                                  action="{{ action }}"
                                  id="updfam"
                                  data-insert="{% for j in range(1, 100) %}{% with %}{% set test_ev = ev("event", j) %}{% if test_ev == "on" %}fevent_select{{ j + 1 }}/{% endif %}{% endwith %}{% endfor %}{% for j in range(1, 100) %}{% with %}{% set test_ch = ev("ch", j - 1) %}{% if test_ch == "on" %}ch{{ j }}_fn/{% endif %}{% endwith %}{% endfor %}">
                                <div class="row">{{ nav() }}</div>
                                <p class="my-0">
                                    {{ hidden }}
                                    <input type="hidden" name="digest" value="{{ digest }}">
                                    {% if evar_ip != "" %}
                                        <input type="hidden" name="ip" value="{{ evar_ip }}">
                                        {{ nl }}
                                    {% endif %}
                                    {% if evar_i != "" %}
                                        <input type="hidden" name="i" value="{{ evar_i }}">
                                        {{ nl }}
                                    {% endif %}
                                    {% if evar_m == "ADD_FAM" or evar_m == "ADD_FAM_OK" %}
                                        <input type="hidden" name="m" value="ADD_FAM_OK">
                                        {{ nl }}
                                    {% else %}
                                        {% if evar_m == "ADD_PAR" or evar_m == "ADD_PAR_OK" %}
                                            <input type="hidden" name="m" value="ADD_PAR_OK">
                                            {{ nl }}
                                        {% else %}
                                            {% if evar_m == "MOD_FAM" or evar_m == "MOD_FAM_OK" %}
                                                <input type="hidden" name="m" value="MOD_FAM_OK">
                                                {{ nl }}
                                            {% else %}
                                                {% if evar_m == "MRG_DUP_FAM_Y_N" or evar_m == "MRG_FAM" or evar_m == "MRG_FAM_OK" or evar_m == "MRG_MOD_FAM_OK" %}
                                                    <input type="hidden" name="i2" value="{{ evar_i2 }}">
                                                    {% if evar_ini1 != "" and evar_ini2 != "" %}
                                                        <input type="hidden" name="ini1" value="{{ evar_ini1 }}">
                                                        <input type="hidden" name="ini2" value="{{ evar_ini2 }}">
                                                    {% endif %}
                                                    {% if evar.iexcl != "" %}<input type="hidden" name="iexcl" value="{{ evar.iexcl }}">{% endif %}
                                                    {% if evar.fexcl != "" %}<input type="hidden" name="fexcl" value="{{ evar.fexcl }}">{% endif %}
                                                    <input type="hidden" name="m" value="MRG_MOD_FAM_OK">
                                                    {{ nl }}
                                                {% endif %}
                                            {% endif %}
                                        {% endif %}
                                    {% endif %}
                                </p>
                                <div class="card">
                                    {{ card_header('parents', 'parents') }}
                                    <div class="card-body">
                                        <div class="row">
                                            {# foreach not implemented yet #}
                                            <button type="submit"
                                                    class="btn btn-outline-primary col-3 ml-auto mt-3 mr-3"
                                                    title="{{ _('validate/delete', variant='0') |capitalize }}"
                                                    aria-label="{{ _('validate/delete', variant='0') |capitalize }}">
                                                <span class="font-weight-bold text-uppercase sr-only">{{ _('validate/delete', variant='0') |capitalize }}</span>
                                                OK <i class="fa fa-share fa-rotate-180 fa-fw ml-1" aria-hidden="true"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="card">
                                    {{ card_header('events', 'event/events') }}
                                    <div class="card-body">
                                        {% if has_fevents %}
                                            {# foreach not implemented yet #}
                                        {% else %}
                                            {{ one_fevent("1", has_fevents) }}{{ insert_fevent("1") }}
                                        {% endif %}
                                    </div>
                                </div>
                                {% macro insert_child(xcnt) %}
                                    <label for="ins_chxcnt_n" class="col-form-label col-2">{{ _("insert") |capitalize }}</label>
                                    <div class="form-inline col-5">
                                        <div class="input-group">
                                            <select class="form-control bg-light border-primary border-right-0"
                                                    id="ins_chxcnt_n"
                                                    name="ins_chxcnt_n">
                                                {% for i in range(1, 11) %}<option>{{ i }}</option>{% endfor %}
                                            </select>
                                            <div class="input-group-append">
                                                <label class="btn btn-outline-primary border-left-0">
                                                    {{ _('child/children', variant='2') }}
                                                    <input class="ml-1" type="checkbox" name="ins_chxcnt" value="on">
                                                </label>
                                                <button type="submit"
                                                        class="btn btn-outline-primary"
                                                        title="{{ _('insert::child/children', variant='2') |capitalize }}">
                                                    OK
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                {% endmacro %}
                                {% macro invert_children(xcnt) %}
                                    <div class="form-inline col-2 ml-auto">
                                        <button type="submit"
                                                class="btn btn-outline-secondary btn-sm"
                                                name="inv_chxcnt"
                                                value="on"
                                                title="{{ _("invert") |capitalize }} {{ _('child/children', variant='0') }} {{ xcnt - 1 }} {{ _("and") }} xcnt">
                                            <i class="far fa-user"></i> {{ xcnt - 1 }}<i class="fa fa-right-left fa-rotate-90 mx-2"></i>xcnt <i class="far fa-user"></i>
                                        </button>
                                    </div>
                                {% endmacro %}
                                {% macro child(xcnt) %}
                                    <div class="row">
                                        <hr class="w-100">
                                        <h5 class="col-form-label col-sm-2 text-uppercase">
                                            {{ nth(_('nth') , cnt) }} {{ _('child/children', variant='0') |capitalize }}
                                        </h5>
                                        <div class="col-sm-2">
                                            <select class="form-control" name="chxcnt_p" id="chxcnt_p_selct">
                                                <option value="link"{% if child.create == "link" %} selected{% endif %}>
                                                    {{ _('link', variant='0') |capitalize }}
                                                </option>
                                                <option value="create"{% if child.create == "create" %} selected{% endif %}>
                                                    {{ _('create', variant='0') |capitalize }}
                                                </option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <label for="chxcnt_fn" class="col-sm-2 col-form-label">
                                            {{ _('first name/first names', variant='0') |capitalize }}
                                        </label>
                                        <div class="col-sm-6">
                                            <input class="form-control"
                                                   type="text"
                                                   name="chxcnt_fn"
                                                   value="{{ child.first_name }}"
                                                   id="chxcnt_fn"
                                                   placeholder="{{ _('first name/first names', variant='0') |capitalize }}"
                                                   {{ datalist_fnames }}>
                                        </div>
                                        <label for="chxcnt_occ" class="col-sm-auto col-form-label">{{ _("number") |capitalize }}</label>
                                        <div class="col-sm-2">
                                            <input class="form-control"
                                                   type="number"
                                                   name="chxcnt_occ"
                                                   min="0"
                                                   value="{% if child.occ == "" %}0{% else %}{{ child.occ }}{% endif %}"
                                                   id="chxcnt_occ">
                                        </div>
                                    </div>
                                    <div class="row">
                                        <label for="chxcnt_sn" class="col-sm-2 col-form-label">{{ _('surname/surnames', variant='0') |capitalize }}</label>
                                        <div class="col-sm-6">
                                            <input class="form-control"
                                                   type="text"
                                                   name="chxcnt_sn"
                                                   value="{{ child.surname }}"
                                                   id="chxcnt_sn"
                                                   placeholder="{{ father.surname }}"
                                                   {{ datalist_snames }}>
                                        </div>
                                        <div id="chxcnt_p_selct_mod" class="col-form-label ml-2">
                                            {% if child.index != "-1" %}
                                                <a href="{{ prefix_base_password }}m=MOD_IND&i={{ child.index }}"
                                                   title="{{ _('modify::person/persons', variant='0') |capitalize }} {{ child.first_name }}{% if child.occ != "" %}.{{ child.occ }}{% endif %} {{ child.surname }}"
                                                   aria-hidden="true"
                                                   aria-label="{{ nth_c(_('M/F', variant='0') +_('M/F', variant='1')+"N", child.sex) }}">
                                                    <i class="fa fa-user-pen fa-fw {% if child.sex == 1 %}fe{% endif %}male ml-2 mr-1"></i>
                                                {{ _("modify") |capitalize }} {{ nth(_('nth') , cnt) }} {{ _('child/children', variant='0') }}</a>
                                            {% endif %}
                                        </div>
                                        <div id="chxcnt_p_selct_sex">
                                            <div class="d-inline-flex">
                                                <span class="col-sm-auto col-form-label">{{ _("sex") |capitalize }}</span>
                                                <div class="col-sm-auto mt-2">
                                                    <div class="form-check form-check-inline">
                                                        <label class="form-check-label">
                                                            <input class="form-check-input"
                                                                   type="radio"
                                                                   name="chxcnt_sex"
                                                                   value="M"
                                                                   {% if child.create.sex == "male" %}checked{% endif %}>
                                                            {{ _('M/F', variant='0') }}
                                                        </label>
                                                    </div>
                                                    <div class="form-check form-check-inline">
                                                        <label class="form-check-label">
                                                            <input class="form-check-input"
                                                                   type="radio"
                                                                   name="chxcnt_sex"
                                                                   value="N"
                                                                   {% if child.create.sex == "neuter" %}checked{% endif %}>
                                                            ?
                                                        </label>
                                                    </div>
                                                    <div class="form-check form-check-inline">
                                                        <label class="form-check-label">
                                                            <input class="form-check-input"
                                                                   type="radio"
                                                                   name="chxcnt_sex"
                                                                   value="F"
                                                                   {% if child.create.sex == "female" %}checked{% endif %}>
                                                            {{ _('M/F', variant='1') }}
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="chxcnt_p_selct_data">
                                        {{ birth('chxcnt', 'child', 'true') }}{{ death('chxcnt', 'child', 'true') }}
                                        <div class="row">
                                            <label for="chxcnt_occu" class="col-sm-2 col-form-label">
                                                {{ _('occupation/occupations', variant='0') |capitalize }}
                                            </label>
                                            <div class="col-sm">
                                                <input class="form-control"
                                                       type="text"
                                                       name="chxcnt_occu"
                                                       value="{{ child.create.occupation }}"
                                                       id="chxcnt_occu"
                                                       placeholder="{{ _('occupation/occupations', variant='0') |capitalize }}"
                                                       {{ datalist_occupations }}>
                                            </div>
                                        </div>
                                    </div>
                                {% endmacro %}
                                <div class="card">
                                    {{ card_header('children', 'child/children') }}
                                    <div class="card-body">
                                        <div class="row">{{ insert_child("0") }}{# foreach not implemented yet #}</div>
                                    </div>
                                </div>
                                <div class="card">
                                    {{ card_header('sources', 'source/sources') }}
                                    <div class="card-body">
                                        <div class="row">
                                            <label for="psrc" class="col-sm-2 col-form-label">[*person/persons]1</label>
                                            <div class="col-sm-10">
                                                <textarea class="form-control" rows="1" name="psrc" id="psrc" placeholder="{{ _('source/sources', variant='1')|capitalize }} {{ _('person/persons', variant='1') }}"datalist_sources;>
{% if evar_psrc != "" %}{{ evar_psrc }}{% else %}{{ evar_dsrc }}{% endif %}</textarea>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <label for="src" class="col-sm-2 col-form-label">{{ _('family/families', variant='0') |capitalize }}</label>
                                            <div class="col-sm-9">
                                                {% if fsources != "" %}
                                                    <textarea class="form-control"
                                                              name="src"
                                                              rows="1"
                                                              id="src"
                                                              placeholder="{{ _('source/sources', variant='1')|capitalize }} {{ _('family/families', variant='0') }}"
                                                              {{ l_on1s }}>{{ fsources }}</textarea>
                                                {% else %}
                                                    <input class="form-control"
                                                           name="src"
                                                           id="src"
                                                           placeholder="{{ _('source/sources', variant='1') |capitalize }} {{ _('family/families', variant='0') }}"
                                                           value="{{ fsources }}"
                                                           datalist_sources>
                                                {% endif %}
                                            </div>
                                            <div class="col-sm-1">
                                                <label class="form-check-label">
                                                    <input type="checkbox"
                                                           name="rdsrc"
                                                           value="on"
                                                           {% if evar_rdsrc == "on" %}checked{% endif %}>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                {% if bvar.origin_file == "on" %}
                                    <input type="text"
                                           name="origin_file"
                                           size="50"
                                           maxlength="200"
                                           value="{{ origin_file }}">
                                {% endif %}
                                <div class="card">
                                    {{ card_header('comments', 'comment') }}
                                    <div class="d-inline-flex flex-column">
                                        <div class="col py-1">{% include 'toolbar.html.j2' %}</div>
                                        <div class="row">
                                            <div class="d-flex flex-column col-9">
                                                <textarea class="form-control insert-character-target no-clear-button ml-2"
                                                          id="notes_comments"
                                                          name="comment"
                                                          rows="21">{{ comment }}</textarea>
                                                <button type="submit"
                                                        class="btn btn-outline-primary btn-lg mx-auto py-3 px-5 my-3"
                                                        title="{{ _('validate/delete', variant='0') |capitalize }}"
                                                        aria-label="{{ _('validate/delete', variant='0') |capitalize }}">
                                                    <span class="font-weight-bold text-uppercase">{{ _('validate/delete', variant='0') |capitalize }}</span><i class="fa fa-share fa-rotate-180 fa-fw ml-2" aria-hidden="true"></i>
                                                </button>
                                            </div>
                                            <div class="col mx-2 pl-0 pr-3 py-0">{% include 'characters.html.j2' %}</div>
                                        </div>
                                    </div>
                                </div>
                            </form>
                            {% include 'trl.html.j2' %}
                            {% include 'copyr.html.j2' %}
                        </div>
                        {% include 'js.html.j2' %}
                        {{ query_time }}
                        {% include 'upd_js.html.j2' %}
                        <script>
                            function show_fevent_label(xxname, xcnt) {
                                var selector = document.getElementById('fevent_select' + xcnt);
                                var label = document.getElementById('fevent_label_selector' + xcnt);
                                var input = document.getElementById('e_name' + xcnt);
                                if (selector.value == "") {
                                    if (xxname.charAt(0) != "#" && xxname != "") {
                                        input.value = xxname;
                                    } else {
                                        input.value = "";
                                    }
                                } else {
                                    input.value = selector.value;
                                }
                                if (selector.options {
                                        {
                                            _('selector.selectedIndex')
                                        }
                                    }.id === "custom" + xcnt) {
                                    label.style.display = 'inline';
                                    input.style.display = 'inline';
                                } else {
                                    label.style.display = 'none';
                                    input.style.display = 'none';
                                }
                            }
                            $(document).ready(function() {
                                //show evt perso
                                $(".other_evts").each(function() {
                                    var inp = $(this).find("input").first();
                                    if (inp.val().charAt(0) != "#" && inp.val() != "") {
                                        $(this).show();
                                    }
                                });
                            });
                        </script>
                        <script>
                            $(document).ready(function() {
                                var targetId = $('#updfam').data('insert').split('/') {
                                    {
                                        _('0')
                                    }
                                };
                                if (!targetId) {
                                    var $inputs = $('#updfam').find('input{{ _('
                                        type = "text"
                                        ') }}');
                                    targetId = $inputs.filter(function() {
                                        return (this.id.startsWith('e_place') || this.id.endsWith('_fn')) && this.value === '';
                                    }).first().attr('id');
                                }
                                if (targetId) {
                                    $('#' + targetId).focus();
                                }
                            });
                        </script>
                    </body>
                </html>
            {% endwith %}
        {% endwith %}
    {% endwith %}
{% endwith %}
{% endwith %}
{% endwith %}
