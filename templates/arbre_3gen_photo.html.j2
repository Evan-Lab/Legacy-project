{# 
  Generated by JinjaGenerator for template 'modules/arbre_3gen_photo'
    at 2025-10-26T20:25:10.187715

  Used macros:
  - vt(xx, yy, zz, cc)
  - ttl(ss, gg)
  - setvar(nnn, vvv)
  - fam_dates(xx)
  - ind(xx, gg)

  Used includes:
  None

  Used variables:
  - op_m (x3)
  - b.display_sosa (x1)
  - b.default_image (x1)
  - xx.has_sosa (x1)
  - xx.father.access (x1)
  - xx.has_image (x2)
  - xx.has_blason (x2)
  - xx.image_url (x2)
  - xx.image_small_size (x1)
  - xx (x2)
  - xx.sex (x3)
  - xx.blason_url (x2)
  - xx.blason_small_size (x1)
  - yy.has_sosa (x1)
  - zz (x1)
  - self (x2)
  - self.has_sosa (x1)
  - sosa_ref (x1)
  - cc (x2)
  - ss (x1)
  - gg (x4)
  - set_var.nnn.vvv (x1)
  - spouse.access (x1)
  - family.date_s (x2)
  - has_parents (x2)
  - father.has_parents (x5)
  - mother.has_parents (x5)
  - get_var.mar_father (x1)
  - get_var.mar_mother (x1)
  - marriage_sep_check (x1)
  - cancel_links (x4)
  - images_prefix (x1)
  - vtbr (x4)
  - right (x6)
  - left (x6)
  - has_siblings (x1)
#}
<!-- $Id: modules/arbre_3gen_photo.txt v7.1 22/04/2024 07:27:12 $ -->
{% with %}
    {% set op_m = (op_m) if (( op_m != "" )) else ("1") %}
    {% macro vt(xx, yy, zz, cc) %}
        {% if ( ( b.display_sosa == "yes" ) and ( ( ( ( "xx" != "" ) and xx.has_sosa ) or ( ( "yy" != "" ) and yy.has_sosa ) ) and ( ( "zz" in "yy" ) or ( ( "zz" in "yy" ) or ( ( ( zz == self ) and ( self == sosa_ref ) ) or self.has_sosa ) ) ) ) ) %}
            ║
            {% if ( cc == 2 ) %}
                <br>
                ║
            {% endif %}
        {% else %}
            │
            {% if ( cc == 2 ) %}
                <br>
                │
            {% endif %}
        {% endif %}
    {% endmacro %}
    {% macro ttl(ss, gg) %}
        {% if ( ss == 0 ) %}
            {% if ( gg == 2 ) %}
                ({{ _("a grandfather/a grandmother/a grandparent", variant='0') }})
            {% else %}
                ({{ _("father/mother", variant='0') }})
            {% endif %}
        {% else %}
            {% if ( gg == 2 ) %}
                ({{ _("a grandfather/a grandmother/a grandparent", variant='1') }})
            {% else %}
                ({{ _("father/mother", variant='1') }})
            {% endif %}
        {% endif %}
    {% endmacro %}
    {% macro setvar(nnn, vvv) %}
        {{ set_var.nnn.vvv }}
    {% endmacro %}
    {% macro fam_dates(xx) %}
        {% if ( ( spouse.access == xx.father.access ) and ( family.date_s != "" ) ) %}
            {{ setvar("mar_xx", family.date_s) }}
        {% endif %}
    {% endmacro %}
    {% if has_parents %}
        {% if father.has_parents %}{# foreach not implemented yet #}{% endif %}{% if mother.has_parents %}{# foreach not implemented yet #}
        {% endif %}
    {% endif %}
    {% with %}
        {% set marriage_sep_check = get_var.mar_fatherget_var.mar_mother %}
        {% with %}
            {% set vtbr = ("2") if (( "-" in marriage_sep_check )) else ("1") %}
            {% macro ind(xx, gg) %}
                {% if ( xx.has_image or xx.has_blason ) %}
                    {% if xx.has_image %}
                        {% if ( not cancel_links ) %}<a href="{{ xx.image_url }}" target="_blank">{% endif %}
                            <img class="rounded"
                                 {{ xx.image_small_size }}
                                 src="{{ xx.image_url }}"
                                 alt="{{ _("image/images", variant='0') }}"
                                 title="{{ xx }} {{ ttl(xx.sex, gg) }}">
                            {% if ( not cancel_links ) %}</a>{% endif %}
                    {% else %}
                        {% if xx.has_blason %}
                            {% if ( not cancel_links ) %}<a href="{{ xx.blason_url }}" target="_blank">{% endif %}
                                <img class="rounded"
                                     {{ xx.blason_small_size }}
                                     src="{{ xx.blason_url }}"
                                     alt="{{ _("image/images", variant='0') }}"
                                     title="{{ xx }} {{ ttl(xx.sex, gg) }}">
                                {% if ( not cancel_links ) %}</a>{% endif %}
                        {% endif %}
                    {% endif %}
                {% else %}
                    {% if ( b.default_image == "yes" ) %}
                        <img height="75"
                             src="{{ images_prefix }}img_unknown_{% if ( xx.sex == 1 ) %}wo{% endif %}man.png"
                             alt="{{ _("missing image") }}">
                    {% endif %}
                {% endif %}
                {{ short_display_person_tree("xx") }}
            {% endmacro %}
            {% if has_parents %}
                <table class="mt-2 mt-md-0 mx-auto px-0 text-center{% if ( op_m == 2 ) %} small{% endif %}"
                       style="line-height:0.9rem">
                    <tr>
                        {% if father.has_parents %}
                            <td colspan="4" class="align-bottom">{{ ind('father.father', 2) }}</td>
                            <td></td>
                            <td colspan="4" class="align-bottom">{{ ind('father.mother', 2) }}</td>
                        {% else %}
                            <td colspan="9" rowspan="4"></td>
                        {% endif %}
                        <td></td>
                        {% if mother.has_parents %}
                            <td colspan="4" class="align-bottom">{{ ind('mother.father', 2) }}</td>
                            <td></td>
                            <td colspan="4" class="align-bottom">{{ ind('mother.mother', 2) }}</td>
                        {% else %}
                            <td colspan="9" rowspan="4"></td>
                        {% endif %}
                    </tr>
                    <tr>
                        {% if father.has_parents %}
                            <td></td>
                            <td colspan="2">{{ vt("father.father", "", "", vtbr) }}</td>
                            <td colspan="3"
                                class="small align-text-center text-center font-italic col-1 px-1">
                                {{ display_date_marriage_parent("father") }}
                            </td>
                            <td colspan="2">{{ vt("father.mother", "", "", vtbr) }}</td>
                            <td></td>
                        {% endif %}
                        <td></td>
                        {% if mother.has_parents %}
                            <td></td>
                            <td colspan="2">{{ vt("mother.father", "", "", vtbr) }}</td>
                            <td colspan="3"
                                class="small align-text-center text-center font-italic col-1 px-1">
                                {{ display_date_marriage_parent("mother") }}
                            </td>
                            <td colspan="2">{{ vt("mother.mother", "", "", vtbr) }}</td>
                            <td></td>
                        {% endif %}
                    </tr>
                    <tr>
                        {% if father.has_parents %}
                            <td></td>
                            <td colspan="2" class="p-0" align="{{ right }}">
                                <hr dir="ltr" width="50%" align="{{ right }}">
                            </td>
                            <td colspan="3" class="p-0">
                                <hr width="100%">
                            </td>
                            <td colspan="2" class="p-0" align="{{ left }}">
                                <hr dir="ltr" width="50%" align="{{ left }}">
                            </td>
                            <td></td>
                        {% endif %}
                        <td></td>
                        {% if mother.has_parents %}
                            <td></td>
                            <td colspan="2" class="p-0" align="{{ right }}">
                                <hr dir="ltr" width="50%" align="{{ right }}">
                            </td>
                            <td colspan="3" class="p-0">
                                <hr width="100%">
                            </td>
                            <td colspan="2" class="p-0" align="{{ left }}">
                                <hr dir="ltr" width="50%" align="{{ left }}">
                            </td>
                            <td></td>
                        {% endif %}
                    </tr>
                    <tr>
                        {% if father.has_parents %}
                            <td colspan="3"></td>
                            <td colspan="3" class="pt-0">{{ vt('father.father', 'father.mother', 'father', 1) }}</td>
                            <td colspan="3"></td>
                        {% endif %}
                        <td></td>
                        {% if mother.has_parents %}
                            <td colspan="3"></td>
                            <td colspan="3" class="pt-0">{{ vt('mother.father', 'mother.mother', 'mother', 1) }}</td>
                            <td colspan="3"></td>
                        {% endif %}
                    </tr>
                    <tr>
                        <td colspan="2"></td>
                        <td colspan="5" class="align-bottom">{{ ind('father', 1) }}</td>
                        <td colspan="2"></td>
                        <td></td>
                        <td colspan="2"></td>
                        <td colspan="5" class="align-bottom">{{ ind('mother', 1) }}</td>
                        <td colspan="2"></td>
                    </tr>
                    <tr>
                        <td colspan="3"></td>
                        <td colspan="3">{{ vt('father', '', '', 1) }}</td>
                        <td colspan="1"></td>
                        <td colspan="5"
                            class="small align-text-center text-center font-italic col-1 px-0">
                            {{ display_date_marriage_parent("self") }}
                        </td>
                        <td colspan="1"></td>
                        <td colspan="3">{{ vt('mother', '', '', 1) }}</td>
                        <td colspan="3"></td>
                    </tr>
                    <tr>
                        <td colspan="3"></td>
                        <td colspan="3" class="p-0" align="{{ right }}">
                            <hr dir="ltr" width="50%" align="{{ right }}">
                        </td>
                        <td colspan="7" class="p-0">
                            <hr width="100%">
                        </td>
                        <td colspan="3" class="p-0" align="{{ left }}">
                            <hr dir="ltr" width="50%" align="{{ left }}">
                        </td>
                        <td colspan="3"></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td>{{ vt('father', 'mother', 'self', 1) }}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    {% if ( not has_siblings ) %}
                        <tr>
                            <td colspan="5"></td>
                            <td colspan="9">{{ short_display_person_tree("self") }}</td>
                            <td colspan="5"></td>
                        </tr>
                    {% endif %}
                </table>
            {% endif %}
        {% endwith %}
    {% endwith %}
{% endwith %}
