{# 
  Generated by JinjaGenerator for template 'updhist_diff'
    at 2025-10-26T20:24:52.123319

  Used macros:
  - no_diff(xx)
  - print_summary()
  - empty()
  - print_diff_person()
  - print_diff_family()
  - print_diff()

  Used includes:
  - css
  - hed
  - home
  - trl
  - copyr
  - js

  Used variables:
  - lang (x1)
  - body_prop (x1)
  - acces (x1)
  - person (x2)
  - evar.t (x4)
  - evar.f (x4)
  - evar.old (x5)
  - evar.m (x3)
  - evar.new (x6)
  - action (x1)
  - hidden (x1)
  - history_len (x2)
  - before.first_name (x2)
  - before.surname (x2)
  - before.occ (x2)
  - before.sex (x2)
  - before.public_name (x2)
  - before.image (x2)
  - before.qualifiers (x2)
  - before.aliases (x2)
  - before.first_names_aliases (x2)
  - before.surnames_aliases (x2)
  - before.occupation (x2)
  - before.relations (x2)
  - before.titles (x2)
  - before.psources (x2)
  - before.notes (x2)
  - before.access (x2)
  - before.date (x1)
  - before.wizard (x1)
  - after.first_name (x2)
  - after.surname (x2)
  - after.occ (x2)
  - after.sex (x2)
  - after.public_name (x2)
  - after.image (x2)
  - after.qualifiers (x2)
  - after.aliases (x2)
  - after.first_names_aliases (x2)
  - after.surnames_aliases (x2)
  - after.occupation (x2)
  - after.relations (x2)
  - after.titles (x2)
  - after.psources (x2)
  - after.notes (x2)
  - after.access (x2)
  - after.date (x1)
  - after.wizard (x1)
  - nb_families (x1)
  - query_time (x1)
#}
<!DOCTYPE html>
<html lang="{{ lang }}">
    <head>
        <!-- $Id: updhist_diff.txt v7.1 10/01/2023 20:01:49 $ -->
        <title>{{ _("revision history") |capitalize }}</title>
        <meta name="robots" content="none">
        <meta charset="UTF-8">
        <meta name="viewport"
              content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="shortcut icon"
              href="{{ url_for('static', path='images/favicon_gwd.png') }}">
        {% include 'css.html.j2' %}
    </head>
    <body {{ body_prop }}>
        {% include 'hed.html.j2' %}
        {% include 'home.html.j2' %}
        <div class="container">
            <script>
                <!--
                function update_new() {
                    var input_new = $('input{{ _("type=radio") }}{{ _("name=new") }}:checked').val(),
                        input_old = $('input{{ _("type=radio") }}{{ _("name=old") }}:checked').val();
                    if (input_new >= input_old) {
                        var tmp = parseInt(input_new) + 1;
                        $('input{{ _("type=radio") }}{{ _("name=old") }}{{ _("value=' + input_old + '") }}').prop('checked', false);
                        $('input{{ _("type=radio") }}{{ _("name=old") }}{{ _("value=' + tmp + '") }}').prop('checked', true);
                    }
                }

                function update_old() {
                    var input_new = $('input{{ _("type=radio") }}{{ _("name=new") }}:checked').val(),
                        input_old = $('input{{ _("type=radio") }}{{ _("name=old") }}:checked').val();
                    if (input_old <= input_new) {
                        var tmp = parseInt(input_old) - 1;
                        $('input{{ _("type=radio") }}{{ _("name=new") }}{{ _("value=' + input_new + '") }}').prop('checked', false);
                        $('input{{ _("type=radio") }}{{ _("name=new") }}{{ _("value=' + tmp + '") }}').prop('checked', true);
                    }
                }
                -->
            </script>
            <h1 class="text-center">
                <a href="/{{ acces }}">{{ person }}</a>
                {% if ( evar.t == "SUM" ) %}
                    , {{ _("revision history") }}
                {% else %}
                    <br>
                    {{ _("difference between the two revisions") }}
                {% endif %}
            </h1>
            {% macro no_diff(xx) %}
                {{ _("insufficient revision history for %s:::xx") |capitalize }}
            {% endmacro %}
            {% macro print_summary() %}
                <form method="GET" action="{{ action }}">
                    <p>{{ hidden }}</p>
                    <input type="hidden" name="m" value="HIST_DIFF" />
                    <input type="hidden" name="t" value="DIFF" />
                    <input type="hidden" name="f" value="{{ evar.f }}" />
                    {% if ( history_len >= 2 ) %}
                        <button type="submit" class="btn btn-outline-primary mb-2">{{ _("compare selected revisions") |capitalize }}</button>
                    {% else %}
                        {{ no_diff(person) }}
                    {% endif %}
                    <table class="table table-hover table-sm">
                        <tr class="text-center">
                            <th>{{ _("compare") |capitalize }}</th>
                            <th>{{ _("date/dates", variant='0') |capitalize }}</th>
                            <th>{{ _("wizard/wizards/friend/friends/exterior", variant='0') |capitalize }}</th>
                        </tr>
                        {# foreach not implemented yet #}
                    </table>
                </form>
            {% endmacro %}
            {% macro empty() %}
                <tr>
                    <td colspan="3"></td>
                </tr>
            {% endmacro %}
            {% macro print_diff_person() %}
                {% if ( ( before.first_name != after.first_name ) or ( ( before.surname != after.surname ) or ( before.occ != after.occ ) ) ) %}
                    <tr>
                        <th scope="row" class="table-success text-nowrap">{{ _("name") |capitalize }}</th>
                        <td class="odd">{{ before.first_name }}.{{ before.occ }} {{ before.surname }}</td>
                        <td class="odd">{{ after.first_name }}.{{ after.occ }} {{ after.surname }}</td>
                    </tr>
                {% endif %}
                {% if ( before.sex != after.sex ) %}
                    <tr>
                        <th scope="row" class="table-success text-nowrap">{{ _("sex") |capitalize }}</th>
                        <td class="odd">{{ before.sex }}</td>
                        <td class="odd">{{ after.sex }}</td>
                    </tr>
                {% endif %}
                {% if ( before.public_name != after.public_name ) %}
                    <tr>
                        <th scope="row" class="table-success text-nowrap">{{ _("public name") |capitalize }}</th>
                        <td class="odd">{{ before.public_name }}</td>
                        <td class="odd">{{ after.public_name }}</td>
                    </tr>
                {% endif %}
                {% if ( before.image != after.image ) %}
                    <tr>
                        <th scope="row" class="table-success text-nowrap">{{ _("image/images", variant='0') |capitalize }}</th>
                        <td class="odd">{{ before.image }}</td>
                        <td class="odd">{{ after.image }}</td>
                    </tr>
                {% endif %}
                {% if ( before.qualifiers != after.qualifiers ) %}
                    <tr>
                        <th scope="row" class="table-success text-nowrap">{{ _("qualifier") |capitalize }}</th>
                        <td class="odd">{{ before.qualifiers }}</td>
                        <td class="odd">{{ after.qualifiers }}</td>
                    </tr>
                {% endif %}
                {% if ( before.aliases != after.aliases ) %}
                    <tr>
                        <th scope="row" class="table-success text-nowrap">{{ _("alias") |capitalize }}</th>
                        <td class="odd">{{ before.aliases }}</td>
                        <td class="odd">{{ after.aliases }}</td>
                    </tr>
                {% endif %}
                {% if ( before.first_names_aliases != after.first_names_aliases ) %}
                    <tr>
                        <th scope="row" class="table-success text-nowrap">{{ _("first name alias") |capitalize }}</th>
                        <td class="odd">{{ before.first_names_aliases }}</td>
                        <td class="odd">{{ after.first_names_aliases }}</td>
                    </tr>
                {% endif %}
                {% if ( before.surnames_aliases != after.surnames_aliases ) %}
                    <tr>
                        <th scope="row" class="table-success text-nowrap">{{ _("surname alias") |capitalize }}</th>
                        <td class="odd">{{ before.surnames_aliases }}</td>
                        <td class="odd">{{ after.surnames_aliases }}</td>
                    </tr>
                {% endif %}
                {% if ( before.occupation != after.occupation ) %}
                    <tr>
                        <th scope="row" class="table-success text-nowrap">{{ _("occupation/occupations", variant='1') |capitalize }}</th>
                        <td class="odd">{{ before.occupation }}</td>
                        <td class="odd">{{ after.occupation }}</td>
                    </tr>
                {% endif %}
                {# foreach not implemented yet #}
                {% if ( before.relations != after.relations ) %}
                    <tr>
                        <th scope="row" class="table-success text-nowrap">{{ _("relation/relations", variant='1') |capitalize }}</th>
                        <td class="odd">{{ before.relations }}</td>
                        <td class="odd">{{ after.relations }}</td>
                    </tr>
                {% endif %}
                {% if ( before.titles != after.titles ) %}
                    {{ empty() }}
                    <tr>
                        <th scope="row" class="table-success text-nowrap">{{ _("title/titles", variant='1') |capitalize }}</th>
                        <td class="odd">{{ before.titles }}</td>
                        <td class="odd">{{ after.titles }}</td>
                    </tr>
                {% endif %}
                {% if ( before.psources != after.psources ) %}
                    <tr>
                        <th scope="row" class="table-success text-nowrap">{{ _("person source") |capitalize }}</th>
                        <td class="odd">{{ before.psources }}</td>
                        <td class="odd">{{ after.psources }}</td>
                    </tr>
                {% endif %}
                {% if ( before.notes != after.notes ) %}
                    <tr>
                        <th scope="row" class="table-success text-nowrap">{{ _("note/notes", variant='1') |capitalize }}</th>
                        <td class="odd">{{ before.notes }}</td>
                        <td class="odd">{{ after.notes }}</td>
                    </tr>
                {% endif %}
                {% if ( before.access != after.access ) %}
                    {{ empty() }}
                    <tr>
                        <th scope="row" class="table-success text-nowrap">{{ _("access") |capitalize }}</th>
                        <td class="odd">{{ before.access }}</td>
                        <td class="odd">{{ after.access }}</td>
                    </tr>
                {% endif %}
            {% endmacro %}
            {% macro print_diff_family() %}
                {# foreach not implemented yet #}
            {% endmacro %}
            {% macro print_diff() %}
                <div class="text-center">
                    <a {% if ( evar.old == ( history_len - 1 ) ) %}class="invisible"{% endif %}
                       href="/m={{ evar.m }}&t={{ evar.t }}&f={{ evar.f }}&new={{ evar.old }}&old={{ evar.old + 1 }}"
                       title="{{ _("previous/next diff", variant='0') |capitalize }}"><span class="fa fa-arrow-left"></span> {{ _("previous/next diff", variant='0') }}</a> |
                    <a href="/m={{ evar.m }}&t=SUM&f={{ evar.f }}">
                        {% if ( ( evar.old - evar.new ) > 1 ) %}
                            {{ ( evar.old - evar.new ) - 1 }} {{ _("intermediate revisions not shown") }}
                        {% else %}
                            {{ _("revision history") }}
                        {% endif %}
                    </a>
                    | 
                    {% if ( evar.new != 0 ) %}
                        <a href="/m={{ evar.m }}&t={{ evar.t }}&f={{ evar.f }}&new={{ evar.new - 1 }}&old={{ evar.new }}"
                           title="{{ _("previous/next diff", variant='1') |capitalize }}"> {{ _("previous/next diff", variant='1') }} <span class="fa fa-arrow-right"></span></a>
                    {% else %}
                        {% if ( evar.new == 0 ) %}{{ _("last diff") }}{% endif %}
                    {% endif %}
                </div>
                <table class="table mb-0 mt-3">
                    <colgroup>
                        <col style="width:8%;border-right-style:inset">
                        <col style="width:46%;border-right-style:inset">
                        <col style="width:46%">
                    </colgroup>
                    <tr>
                        <th scope="row" class="table-success text-nowrap">{{ _("revision of") |capitalize }}</th>
                        <td>
                            <b>{{ transl_date(before.date) }}</b>
                        </td>
                        <td>
                            <b>{{ transl_date(after.date) }}</b>
                        </td>
                    </tr>
                    <tr>
                        <th scope="row" class="table-success text-nowrap">
                            {{ _("wizard/wizards/friend/friends/exterior", variant='0') |capitalize }}
                        </th>
                        <td>
                            <b>{{ before.wizard }}</b>
                        </td>
                        <td>
                            <b>{{ after.wizard }}</b>
                        </td>
                    </tr>
                </table>
                <table class="table mb-0">
                    <colgroup>
                        <col style="width:8%;;border-right-style:inset">
                        <col style="width:46%;border-right-style:inset">
                        <col style="width:46%">
                    </colgroup>
                    <tr>
                        <td colspan="3">
                            <h2 class="highlight text-center">{{ _("person/persons", variant='0') |capitalize }}</h2>
                        </td>
                    </tr>
                    {{ print_diff_person() }}
                    {% if ( nb_families > 0 ) %}
                        <tr>
                            <td colspan="3">
                                <h2 class="highlight text-center">{{ _("family/families", variant='0') |capitalize }}</h2>
                            </td>
                        </tr>
                        {{ print_diff_family() }}
                    {% endif %}
                </table>
            {% endmacro %}
            {% if ( evar.t == "SUM" ) %}
                {{ print_summary() }}
            {% else %}
                {{ print_diff() }}
            {% endif %}
            {% include 'trl.html.j2' %}
            {% include 'copyr.html.j2' %}
        </div>
        {% include 'js.html.j2' %}
        {{ query_time }}
    </body>
</html>
