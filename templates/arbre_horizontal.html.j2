{# 
  Generated by JinjaGenerator for template 'modules/arbre_horizontal'
    at 2025-10-29T22:35:37.703855

  Used macros:
  - urlset(xx, yy)
  - access_ind(nnn)
  - access(num, nnn)
  - vbar(i, sx, mm, f_m)
  - displ_parent(max, lev, nnn, sx, wid)

  Used includes:
  None

  Used variables:
  - url_set (x1)
  - url_set.sosa.on (x1)
  - url_set.sosa (x1)
  - cancel_links (x2)
  - nnn.is_restricted (x1)
  - nnn (x3)
  - nnn.access (x1)
  - nnn.title (x2)
  - nnn.dates (x2)
  - nnn.has_parents (x4)
  - evars (x1)
  - mm (x6)
  - m1 (x5)
  - n1 (x66)
  - i (x20)
  - sx (x80)
  - f_m (x5)
  - n2 (x1)
  - s1 (x31)
  - min (x2)
  - n4 (x4)
  - max (x13)
  - min1 (x7)
  - max1 (x7)
  - n8 (x8)
  - min2 (x6)
  - max2 (x6)
  - n16 (x16)
  - min3 (x4)
  - max3 (x4)
  - min4 (x4)
  - max4 (x4)
  - n32 (x32)
  - min5 (x2)
  - max5 (x2)
  - min6 (x2)
  - max6 (x2)
  - min7 (x2)
  - max7 (x2)
  - min8 (x2)
  - max8 (x2)
  - lev (x9)
  - l1 (x2)
  - wid (x12)
  - sosf (x2)
  - l2 (x4)
  - ds (x2)
  - sosm (x2)
  - has_parents (x1)
  - evar.vh (x2)
  - evar.twidth (x2)
  - evar.sosa (x4)
  - evarvh (x4)
  - evartw (x5)
#}

<!-- $Id: modules/arbre_horizontal.txt v7.1 30/12/2021 18:24:51 $ -->
{% macro urlset(xx, yy) %}
    {{ url_set }}(xx,yy)
{% endmacro %}
{% macro access_ind(nnn) %}
    {% if cancel_links or nnn.is_restricted %}
        {{ nnn }}
    {% else %}
        <a {{ ext_link("nnn") }} href="/{{ nnn.access }}">{{ nnn }}</a>{{ nnn.title }}
    {% endif %}
    <span class="text-nowrap small">{{ nnn.dates }}</span>
{% endmacro %}
{% macro access(num, nnn) %}
    {% if evars == 1 %}num{% endif %}
    {{ display_sosa("nnn") }}
    {% if "num" == 1 %}
        {{ nnn }}{{ nnn.title }}{{ nnn.dates }}
        <br>
    {% else %}
        {{ access_ind("nnn") }}
        <br>
    {% endif %}
{% endmacro %}
{% macro vbar(i, sx, mm, f_m) %}
    {% with %}
        {% set m1 = mm - 1 %}
        {% with %}
            {% set n1 = ("2") if (m1 == 1) else (("4") if (m1 == 2) else (("8") if (m1 == 3) else (("16") if (m1 == 4) else (("32") if (m1 == 5))))) %}
            {% with %}
                {% set n2 = n1 // 2 %}
                {% with %}
                    {% set n4 = n1 // 4 %}
                    {% with %}
                        {% set n8 = n1 // 8 %}
                        {% with %}
                            {% set n16 = n1 // 16 %}
                            {% with %}
                                {% set n32 = n1 // 32 %}
                                {% if i == 0 %}
                                    {% if mm == 2 %}
                                        {% with %}
                                            {% set s1 = sx + f_m %}
                                            {% with %}
                                                {% set min = n1 + 1 * n2 %}
                                                {% if s1 == min %}
                                                    │
                                                {% else %}
                                                    &nbsp;
                                                {% endif %}
                                            {% endwith %}
                                        {% endwith %}
                                    {% else %}
                                        {% with %}
                                            {% set min = n1 + 1 * n4 %}
                                            {% with %}
                                                {% set max = n1 + 3 * n4 %}
                                                {% if sx >= min and sx < max %}
                                                    │
                                                {% else %}
                                                    &nbsp;
                                                {% endif %}
                                            {% endwith %}
                                        {% endwith %}
                                    {% endif %}
                                {% else %}
                                    {% if i == 1 %}
                                        {% if mm == 3 %}
                                            {% with %}
                                                {% set s1 = sx + f_m %}
                                                {% with %}
                                                    {% set min1 = n1 + 1 * n4 %}
                                                    {% with %}
                                                        {% set max1 = n1 + 3 * n4 %}
                                                        {% if s1 == min1 or s1 == max1 %}
                                                            │
                                                        {% else %}
                                                            &nbsp;
                                                        {% endif %}
                                                    {% endwith %}
                                                {% endwith %}
                                            {% endwith %}
                                        {% else %}
                                            {% with %}
                                                {% set min1 = n1 + 1 * n8 %}
                                                {% with %}
                                                    {% set max1 = n1 + 3 * n8 %}
                                                    {% with %}
                                                        {% set min2 = n1 + 5 * n8 %}
                                                        {% with %}
                                                            {% set max2 = n1 + 7 * n8 %}
                                                            {% if sx >= min1 and sx < max1 or sx >= min2 and sx < max2 %}
                                                                │
                                                            {% else %}
                                                                &nbsp;
                                                            {% endif %}
                                                        {% endwith %}
                                                    {% endwith %}
                                                {% endwith %}
                                            {% endwith %}
                                        {% endif %}
                                    {% else %}
                                        {% if i == 2 %}
                                            {% if mm == 4 %}
                                                {% with %}
                                                    {% set s1 = sx + f_m %}
                                                    {% with %}
                                                        {% set min1 = n1 + 1 * n8 %}
                                                        {% with %}
                                                            {% set max1 = n1 + 3 * n8 %}
                                                            {% with %}
                                                                {% set min2 = n1 + 5 * n8 %}
                                                                {% with %}
                                                                    {% set max2 = n1 + 7 * n8 %}
                                                                    {% if s1 == min1 or s1 == max1 or s1 == min2 or s1 == max2 %}
                                                                        │
                                                                    {% else %}
                                                                        &nbsp;
                                                                    {% endif %}
                                                                {% endwith %}
                                                            {% endwith %}
                                                        {% endwith %}
                                                    {% endwith %}
                                                {% endwith %}
                                            {% else %}
                                                {% with %}
                                                    {% set min1 = n1 + 1 * n16 %}
                                                    {% with %}
                                                        {% set max1 = n1 + 3 * n16 %}
                                                        {% with %}
                                                            {% set min2 = n1 + 5 * n16 %}
                                                            {% with %}
                                                                {% set max2 = n1 + 7 * n16 %}
                                                                {% with %}
                                                                    {% set min3 = n1 + 9 * n16 %}
                                                                    {% with %}
                                                                        {% set max3 = n1 + 11 * n16 %}
                                                                        {% with %}
                                                                            {% set min4 = n1 + 13 * n16 %}
                                                                            {% with %}
                                                                                {% set max4 = n1 + 15 * n16 %}
                                                                                {% if sx >= min1 and sx < max1 or sx >= min2 and sx < max2 or sx >= min3 and sx < max3 or sx >= min4 and sx < max4 %}
                                                                                    │
                                                                                {% else %}
                                                                                    &nbsp;
                                                                                {% endif %}
                                                                            {% endwith %}
                                                                        {% endwith %}
                                                                    {% endwith %}
                                                                {% endwith %}
                                                            {% endwith %}
                                                        {% endwith %}
                                                    {% endwith %}
                                                {% endwith %}
                                            {% endif %}
                                        {% else %}
                                            {% if i == 3 %}
                                                {% if mm == 5 %}
                                                    {% with %}
                                                        {% set s1 = sx + f_m %}
                                                        {% with %}
                                                            {% set min1 = n1 + 1 * n16 %}
                                                            {% with %}
                                                                {% set max1 = n1 + 3 * n16 %}
                                                                {% with %}
                                                                    {% set min2 = n1 + 5 * n16 %}
                                                                    {% with %}
                                                                        {% set max2 = n1 + 7 * n16 %}
                                                                        {% with %}
                                                                            {% set min3 = n1 + 9 * n16 %}
                                                                            {% with %}
                                                                                {% set max3 = n1 + 11 * n16 %}
                                                                                {% with %}
                                                                                    {% set min4 = n1 + 13 * n16 %}
                                                                                    {% with %}
                                                                                        {% set max4 = n1 + 15 * n16 %}
                                                                                        {% if s1 == min1 or s1 == max1 or s1 == min2 or s1 == max2 or s1 == min3 or s1 == max3 or s1 == min4 or s1 == max4 %}
                                                                                            │
                                                                                        {% else %}
                                                                                            &nbsp;
                                                                                        {% endif %}
                                                                                    {% endwith %}
                                                                                {% endwith %}
                                                                            {% endwith %}
                                                                        {% endwith %}
                                                                    {% endwith %}
                                                                {% endwith %}
                                                            {% endwith %}
                                                        {% endwith %}
                                                    {% endwith %}
                                                {% else %}
                                                    {% with %}
                                                        {% set min1 = n1 + 1 * n32 %}
                                                        {% with %}
                                                            {% set max1 = n1 + 3 * n32 %}
                                                            {% with %}
                                                                {% set min2 = n1 + 5 * n32 %}
                                                                {% with %}
                                                                    {% set max2 = n1 + 7 * n32 %}
                                                                    {% with %}
                                                                        {% set min3 = n1 + 9 * n32 %}
                                                                        {% with %}
                                                                            {% set max3 = n1 + 11 * n32 %}
                                                                            {% with %}
                                                                                {% set min4 = n1 + 13 * n32 %}
                                                                                {% with %}
                                                                                    {% set max4 = n1 + 15 * n32 %}
                                                                                    {% with %}
                                                                                        {% set min5 = n1 + 17 * n32 %}
                                                                                        {% with %}
                                                                                            {% set max5 = n1 + 19 * n32 %}
                                                                                            {% with %}
                                                                                                {% set min6 = n1 + 21 * n32 %}
                                                                                                {% with %}
                                                                                                    {% set max6 = n1 + 23 * n32 %}
                                                                                                    {% with %}
                                                                                                        {% set min7 = n1 + 25 * n32 %}
                                                                                                        {% with %}
                                                                                                            {% set max7 = n1 + 27 * n32 %}
                                                                                                            {% with %}
                                                                                                                {% set min8 = n1 + 29 * n32 %}
                                                                                                                {% with %}
                                                                                                                    {% set max8 = n1 + 31 * n32 %}
                                                                                                                    {% if sx >= min1 and sx < max1 or sx >= min2 and sx < max2 or sx >= min3 and sx < max3 or sx >= min4 and sx < max4 or sx >= min5 and sx < max5 or sx >= min6 and sx < max6 or sx >= min7 and sx < max7 or sx >= min8 and sx < max8 %}
                                                                                                                        │
                                                                                                                    {% else %}
                                                                                                                        &nbsp;
                                                                                                                    {% endif %}
                                                                                                                {% endwith %}
                                                                                                            {% endwith %}
                                                                                                        {% endwith %}
                                                                                                    {% endwith %}
                                                                                                {% endwith %}
                                                                                            {% endwith %}
                                                                                        {% endwith %}
                                                                                    {% endwith %}
                                                                                {% endwith %}
                                                                            {% endwith %}
                                                                        {% endwith %}
                                                                    {% endwith %}
                                                                {% endwith %}
                                                            {% endwith %}
                                                        {% endwith %}
                                                    {% endwith %}
                                                {% endif %}
                                            {% else %}
                                                {% if i == 4 %}
                                                    {% if mm == 6 %}
                                                        {% with %}
                                                            {% set s1 = sx + f_m %}
                                                            {% with %}
                                                                {% set min1 = n1 + 1 * n32 %}
                                                                {% with %}
                                                                    {% set max1 = n1 + 3 * n32 %}
                                                                    {% with %}
                                                                        {% set min2 = n1 + 5 * n32 %}
                                                                        {% with %}
                                                                            {% set max2 = n1 + 7 * n32 %}
                                                                            {% with %}
                                                                                {% set min3 = n1 + 9 * n32 %}
                                                                                {% with %}
                                                                                    {% set max3 = n1 + 11 * n32 %}
                                                                                    {% with %}
                                                                                        {% set min4 = n1 + 13 * n32 %}
                                                                                        {% with %}
                                                                                            {% set max4 = n1 + 15 * n32 %}
                                                                                            {% with %}
                                                                                                {% set min5 = n1 + 17 * n32 %}
                                                                                                {% with %}
                                                                                                    {% set max5 = n1 + 19 * n32 %}
                                                                                                    {% with %}
                                                                                                        {% set min6 = n1 + 21 * n32 %}
                                                                                                        {% with %}
                                                                                                            {% set max6 = n1 + 23 * n32 %}
                                                                                                            {% with %}
                                                                                                                {% set min7 = n1 + 25 * n32 %}
                                                                                                                {% with %}
                                                                                                                    {% set max7 = n1 + 27 * n32 %}
                                                                                                                    {% with %}
                                                                                                                        {% set min8 = n1 + 29 * n32 %}
                                                                                                                        {% with %}
                                                                                                                            {% set max8 = n1 + 37 * n32 %}
                                                                                                                            {% if s1 == min1 or s1 == max1 or s1 == min2 or s1 == max2 or s1 == min3 or s1 == max3 or s1 == min4 or s1 == max4 or s1 == min5 or s1 == max5 or s1 == min6 or s1 == max6 or s1 == min7 or s1 == max7 or s1 == min8 or s1 == max8 %}
                                                                                                                                │
                                                                                                                            {% else %}
                                                                                                                                &nbsp;
                                                                                                                            {% endif %}
                                                                                                                        {% endwith %}
                                                                                                                    {% endwith %}
                                                                                                                {% endwith %}
                                                                                                            {% endwith %}
                                                                                                        {% endwith %}
                                                                                                    {% endwith %}
                                                                                                {% endwith %}
                                                                                            {% endwith %}
                                                                                        {% endwith %}
                                                                                    {% endwith %}
                                                                                {% endwith %}
                                                                            {% endwith %}
                                                                        {% endwith %}
                                                                    {% endwith %}
                                                                {% endwith %}
                                                            {% endwith %}
                                                        {% endwith %}
                                                    {% else %}
                                                        not done
                                                    {% endif %}
                                                {% else %}
                                                    not done yet
                                                {% endif %}
                                            {% endif %}
                                        {% endif %}
                                    {% endif %}
                                {% endif %}
                            {% endwith %}
                        {% endwith %}
                    {% endwith %}
                {% endwith %}
            {% endwith %}
        {% endwith %}
    {% endwith %}
{% endmacro %}
{% macro displ_parent(max, lev, nnn, sx, wid) %}
    {% if max >= 7 %}
        lvl >=7 not implemented
    {% else %}
        {% if max == 0 %}
        {% else %}
            {% with %}
                {% set l1 = lev - 1 %}
                {% with %}
                    {% set l2 = (lev - 2) if (lev >= 2) else ("0") %}
                    {% with %}
                        {% set l3 = (lev - 3) if (lev >= 3) else ("0") %}
                        {% if lev == max %}
                            {% with %}
                                {% set sosf = sx * 2 %}
                                {% with %}
                                    {% set sosm = sx * 2 + 1 %}
                                    {% if nnn.has_parents %}
                                        {% for i in range(0, l1) %}
                                            {{ vbar(i, sx, max, 0) }}
                                            {% for j in range(1, wid) %}&nbsp;{% endfor %}
                                        {% endfor %}
                                        ╭
                                        {% for i in range(1, wid) %}─{% endfor %}
                                        {{ access(sosf, "nnn.father") }}
                                    {% endif %}
                                    {% for i in range(0, l2) %}
                                        {{ vbar(i, sx, max, 0) }}
                                        {% for j in range(1, wid) %}&nbsp;{% endfor %}
                                    {% endfor %}
                                    {% with %}
                                        {% set ds = sx - sx // 2 * 2 %}
                                        {% if max > 1 %}
                                            {% if ds == 0 %}
                                                ╭
                                            {% else %}
                                                ╰
                                            {% endif %}
                                            {% for i in range(1, wid) %}─{% endfor %}
                                        {% endif %}
                                        {{ access(sx, "nnn") }}
                                        {% if nnn.has_parents %}
                                            {% for i in range(0, l1) %}
                                                {{ vbar(i, sx, max, 1) }}
                                                {% for j in range(1, wid) %}&nbsp;{% endfor %}
                                            {% endfor %}
                                            ╰
                                            {% for i in range(1, wid) %}─{% endfor %}
                                            {{ access(sosm, "nnn.mother") }}
                                        {% endif %}
                                    {% endwith %}
                                {% endwith %}
                            {% endwith %}
                        {% else %}
                            {% with %}
                                {% set sosf = sx * 2 %}
                                {% with %}
                                    {% set sosm = sx * 2 + 1 %}
                                    {% if nnn.has_parents %}{{ displ_parent(max, lev + 1, "nnn.father", sosf, wid) }}{% endif %}
                                    {% if max == 4 %}
                                        {% for i in range(0, l2) %}
                                            {% if i == 0 and sx == 5 or sx == 6 %}
                                                │
                                            {% else %}
                                                &nbsp;
                                            {% endif %}
                                            {% for j in range(1, wid) %}&nbsp;{% endfor %}
                                        {% endfor %}
                                    {% else %}
                                        {% if max == 5 %}
                                            {% for i in range(0, l2) %}
                                                {% if i == 0 and sx == 5 or sx == 6 or sx >= 10 and sx <= 13 or i == 1 and sx == 9 or sx == 10 or sx == 13 or sx == 14 %}
                                                    │
                                                {% else %}
                                                    &nbsp;
                                                {% endif %}
                                                {% for j in range(1, wid) %}&nbsp;{% endfor %}
                                            {% endfor %}
                                        {% else %}
                                            {% if max == 6 %}
                                                {% for i in range(0, l2) %}
                                                    {% if i == 0 and sx == 5 or sx == 6 or sx >= 10 and sx <= 13 or sx >= 20 and sx <= 27 or i == 1 and sx == 9 or sx == 10 or sx == 13 or sx == 14 or sx >= 18 and sx <= 21 or sx >= 26 and sx <= 29 or i == 2 and sx == 17 or sx == 18 or sx == 21 or sx == 22 or sx == 25 or sx == 26 or sx == 29 or sx == 30 %}
                                                        │
                                                    {% else %}
                                                        &nbsp;
                                                    {% endif %}
                                                    {% for j in range(1, wid) %}&nbsp;{% endfor %}
                                                {% endfor %}
                                            {% endif %}
                                        {% endif %}
                                    {% endif %}
                                    {% with %}
                                        {% set ds = sx - sx // 2 * 2 %}
                                        {% if lev > 1 %}
                                            {% if ds == 0 %}
                                                ╭
                                            {% else %}
                                                ╰
                                            {% endif %}
                                            {% for i in range(1, wid) %}─{% endfor %}
                                        {% endif %}
                                        {{ access(sx, "nnn") }}
                                        {% if nnn.has_parents %}{{ displ_parent(max, lev + 1, "nnn.mother", sosm, wid) }}{% endif %}
                                    {% endwith %}
                                {% endwith %}
                            {% endwith %}
                        {% endif %}
                    {% endwith %}
                {% endwith %}
            {% endwith %}
        {% endif %}
    {% endif %}
{% endmacro %}
{% if has_parents %}
    {% with %}
        {% set evarvh = (evar.vh) if (evar.vh != "") else ("3") %}
        {% with %}
            {% set evartw = (evar.twidth) if (evar.twidth != "") else ("10") %}
            {% with %}
                {% set evars = ("1") if (evar.sosa == "on") else ("0") %}
                <div class="d-flex justify-content-between">
                    <h2>{{ _("preview family tree") |capitalize }}</h2>
                    {% if not cancel_links %}
                        <div class="form-inline">
                            <div class="btn-group mx-2">
                                {% for i in range(1, 7) %}
                                    <a href="{{ url_set("vh", i) }}"
                                       class="btn btn-outline-secondary btn-sm {% if evarvh == i %}disabled font-weight-bold{% endif %}"
                                       title="{% if evarvh != i %}{{ _('visualize/show/hide/summary', variant='1') |capitalize }} {{ i }} {% if i == 1 %}{{ _('generation/generations', variant='0') }}{% else %}{{ _('generation/generations', variant='1') }}{% endif %}{% endif %}">{{ i }}</a>
                                {% endfor %}
                            </div>
                            <div class="mx-2">
                                <a href="{% if evar.sosa != "on" %}{{ url_set.sosa.on }}{% else %}{{ url_set.sosa }}{% endif %}"
                                   class="btn btn-outline-secondary btn-sm border-0 px-0"
                                   title="{% if evar.sosa != "on" %}{{ _('visualize/show/hide/summary', variant='1') |capitalize }}{% else %}{{ _('visualize/show/hide/summary', variant='2') |capitalize }}{% endif %} {{ _('half-brothers/half-sisters/half-siblings', variant='2') }}">Sosa
                                    <i class="fa fa-toggle-{% if evar.sosa != "on" %}off{% else %}on{% endif %} text-muted"></i>
                                </a>
                            </div>
                            <div class="input-group input-group-sm ">
                                <div class="input-group-prepend">
                                    {% if evartw >= 6 %}
                                        <a href="{{ url_set("twidth", evartw - 2+";") }}"
                                           class="btn btn-outline-secondary"
                                           title="- 2 ({{ _("width") }})">&nbsp;-</a>
                                    {% endif %}
                                </div>
                                <input class="col-3 text-center"
                                       title="{{ _("width") |capitalize }}"
                                       value="{{ evartw }} ─"
                                       disabled>
                                <div class="input-group-append">
                                    <a href="{{ url_set("twidth", evartw + 2+";") }}"
                                       class="btn btn-outline-secondary"
                                       title="+ 2 ({{ _("width") }})">&nbsp;+</a>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                </div>
                <pre class="my-4">
{% if evarvh > 0 %}{{ displ_parent(evarvh, 1, "self", 1, evartw) }}{% else %}{{ access(1, "self") }}{% endif %}</pre>
            {% endwith %}
        {% endwith %}
    {% endwith %}
{% endif %}
